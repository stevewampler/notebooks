{
  "metadata" : {
    "name" : "House of Reps Influence Graphs",
    "user_save_timestamp" : "1969-12-31T18:00:00.000Z",
    "auto_save_timestamp" : "1969-12-31T18:00:00.000Z",
    "language_info" : {
      "name" : "scala",
      "file_extension" : "scala",
      "codemirror_mode" : "text/x-scala"
    },
    "trusted" : true,
    "customLocalRepo" : null,
    "customRepos" : null,
    "customDeps" : null,
    "customImports" : null,
    "customArgs" : null,
    "customSparkConf" : null
  },
  "cells" : [ {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** US Congress Page Rank **"
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "*** Notes: ***\n\n* Quesion: Who are the most influential congressmen/women based on the bills they sponsor and co-sponsor?\n* A short primer on how congress \"works\":\n  * Each \"congress\" has two 1 year sessions starting in January.\n  * We're in the middle of the 114th congress.\n  * Congress is made up of two houses; the senate and the house-of-representatives.\n  * The senate has 100 members; two from each state.\n  * The house currently has 440 members from various districts.\n  * Bills are created and sponsored by one legislator and co-sponsored by zero or more.\n  * Bills are referred to one or more committees where most go to die.\n  * Bills are the primary form of legislative measure used to propose law. Depending on the chamber of origin, bills begin with a designation of either H.R. or S.\n    * Joint resolution is another form of legislative measure used to propose law.\n      * They are a form of legislative measure used to propose changes in law, or to propose an amendment to the U.S. Constitution. Depending on the chamber of origin, they begin with a designation of either H.J.Res. or S.J.Res.\n      * Resolutions dealing with the inner workings of the legislature, or proposed constitutional ammendments, do not require the presedent's signature.\n  * Legislators draft many bills, but few become law.\n  * Bills that pass the house are sent to the senate for debate.\n    * Bill have to pass both houses before going to the president for his signature.\n* In theory, sponsors have influence over co-sponsors.\n  * If so, we should be able to score legislators by\n    * creating a directed graph of co-sponsors to sponsors, and then\n    * run page-rank on the graph.\n  * Could also be that co-sponsors influence sponsors.\n* I'm using Apache Spark and Spark-GraphX running in a \"spark-notebook\":\n  * Apache Spark\n    * \"A fast and general engine for large-scale data processing.\" - Apache\n    * RDDs - Reseliant Distributed Datasets\n    * DataFrames - Table-like structures managed by Spark SQL.\n    * Datasets - A new thing in Spark 1.6\n    * I'm running 1.5.2.\n  * Spark SQL\n    * A way to manipulate data stored in a Spark cluster using SQL and SQL/Scala-like functions.\n  * GraphX\n    * A graph processing framework built into Spark.\n    * A Graph is a collection of \"vertices\" and \"edges\".\n      * Vertices and edges are both RDDs.\n  * Spark Notebooks\n    * Like the \"Lab Notebooks\" of old, but in a browser ... and executable.\n    * \"Persistent, Multi-Language, Editable REPL Sessions\"\n    * Supported Languages:\n      * Markdown\n      * Scala\n      * Shell\n    * Other notebooks:\n      * Jupyter - Python, ???\n      * Beaker - Scala, ???\n      * Zippelen - Scala, Python, JS, sh, ...\n* Congressional data:\n * For the current (114th) congress.\n * Data rsync'd from: https://www.govtrack.us/\n   * Also: https://github.com/govtrack/congress-legislators and https://github.com/unitedstates/congress\n * Legislator CSV File\n   * https://www.govtrack.us/data/congress-legislators/\n * Bills, Votes, Amendments:\n   * https://www.govtrack.us/data/congress/114/\n * Votes\n * Committees\n\n*** See also: ***\n\n* Spark API Docs: http://spark.apache.org/docs/latest/api/scala/index.html\n* Congressional Page Rank: http://www.lyonwj.com/2015/10/11/congressional-pagerank/\n* Congressional Analysis Slides: https://razor.occams.info/pubdocs/2012-10-08_LVI_slides.pdf\n* Legislative Neo4j Graph: https://github.com/legis-graph/legis-graph\n "
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Setup Local Maven Repo and a Few Dependencies **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : ":local-repo /tmp/spark-notebook/",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "res2: String = Repo changed to /tmp/spark-notebook!\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/plain" : "Repo changed to /tmp/spark-notebook!"
      },
      "output_type" : "execute_result",
      "execution_count" : 5
    } ]
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : ":dp  org.apache.spark % spark-graphx_2.10 % 1.2.1\n- org.apache.spark % spark-core_2.10 % _\n- org.apache.hadoop % _ % _\ncom.fasterxml.jackson.module   %  jackson-module-scala_2.10     %    2.3.3",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "warning: there were four feature warnings; re-run with -feature for details\nglobalScope.jars: Array[String] = [Ljava.lang.String;@29cc35a3\nres3: List[String] = List(/tmp/spark-notebook/org/apache/spark/spark-graphx_2.10/1.2.1/spark-graphx_2.10-1.2.1.jar, /tmp/spark-notebook/org/eclipse/jetty/jetty-io/8.1.14.v20131031/jetty-io-8.1.14.v20131031.jar, /tmp/spark-notebook/org/eclipse/jetty/jetty-http/8.1.14.v20131031/jetty-http-8.1.14.v20131031.jar, /tmp/spark-notebook/org/eclipse/jetty/jetty-server/8.1.14.v20131031/jetty-server-8.1.14.v20131031.jar, /tmp/spark-notebook/org/jblas/jblas/1.2.3/jblas-1.2.3.jar, /tmp/spark-notebook/org/eclipse/jetty/orbit/javax.servlet/3.0.0.v201112011016/javax.servlet-3.0.0.v201112011016.jar, /tmp/spark-notebook/org/eclipse/jetty/jetty-continuation/8.1.14.v20131031/jetty-continuation-8.1.14.v20131031.jar, /tmp/spark-notebook/org/spark-..."
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "<div class=\"container-fluid\"><div><div class=\"col-md-12\"><div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon84fbc8b1a21aa6790c970cf2d1a236e6&quot;,&quot;dataInit&quot;:[{&quot;string value&quot;:&quot;/tmp/spark-notebook/org/apache/spark/spark-graphx_2.10/1.2.1/spark-graphx_2.10-1.2.1.jar&quot;},{&quot;string value&quot;:&quot;/tmp/spark-notebook/org/eclipse/jetty/jetty-io/8.1.14.v20131031/jetty-io-8.1.14.v20131031.jar&quot;},{&quot;string value&quot;:&quot;/tmp/spark-notebook/org/eclipse/jetty/jetty-http/8.1.14.v20131031/jetty-http-8.1.14.v20131031.jar&quot;},{&quot;string value&quot;:&quot;/tmp/spark-notebook/org/eclipse/jetty/jetty-server/8.1.14.v20131031/jetty-server-8.1.14.v20131031.jar&quot;},{&quot;string value&quot;:&quot;/tmp/spark-notebook/org/jblas/jblas/1.2.3/jblas-1.2.3.jar&quot;},{&quot;string value&quot;:&quot;/tmp/spark-notebook/org/eclipse/jetty/orbit/javax.servlet/3.0.0.v201112011016/javax.servlet-3.0.0.v201112011016.jar&quot;},{&quot;string value&quot;:&quot;/tmp/spark-notebook/org/eclipse/jetty/jetty-continuation/8.1.14.v20131031/jetty-continuation-8.1.14.v20131031.jar&quot;},{&quot;string value&quot;:&quot;/tmp/spark-notebook/org/spark-project/spark/unused/1.0.0/unused-1.0.0.jar&quot;},{&quot;string value&quot;:&quot;/tmp/spark-notebook/com/fasterxml/jackson/core/jackson-databind/2.3.3/jackson-databind-2.3.3.jar&quot;},{&quot;string value&quot;:&quot;/tmp/spark-notebook/com/thoughtworks/paranamer/paranamer/2.6/paranamer-2.6.jar&quot;},{&quot;string value&quot;:&quot;/tmp/spark-notebook/com/google/guava/guava/13.0.1/guava-13.0.1.jar&quot;},{&quot;string value&quot;:&quot;/tmp/spark-notebook/org/scala-lang/scala-library/2.10.4/scala-library-2.10.4.jar&quot;},{&quot;string value&quot;:&quot;/tmp/spark-notebook/com/google/code/findbugs/jsr305/2.0.1/jsr305-2.0.1.jar&quot;},{&quot;string value&quot;:&quot;/tmp/spark-notebook/com/fasterxml/jackson/core/jackson-core/2.3.3/jackson-core-2.3.3.jar&quot;},{&quot;string value&quot;:&quot;/tmp/spark-notebook/com/fasterxml/jackson/core/jackson-annotations/2.3.3/jackson-annotations-2.3.3.jar&quot;},{&quot;string value&quot;:&quot;/tmp/spark-notebook/com/fasterxml/jackson/module/jackson-module-scala_2.10/2.3.3/jackson-module-scala_2.10-2.3.3.jar&quot;},{&quot;string value&quot;:&quot;file:/Users/wamplers/spark-notebook-0.6.2-scala-2.11.7-spark-1.5.2-hadoop-2.2.0-with-parquet/&quot;},{&quot;string value&quot;:&quot;file:/Users/wamplers/spark-notebook-0.6.2-scala-2.11.7-spark-1.5.2-hadoop-2.2.0-with-parquet/lib/common.common-0.6.2-scala-2.11.7-spark-1.5.2-hadoop-2.2.0-with-parquet.jar&quot;}],&quot;genId&quot;:&quot;181609492&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tableChart'], \n      function(playground, _magictableChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictableChart,\n    \"o\": {\"headers\":[\"string value\"],\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anoncb8f93264f89a225e3f8128b280cecbb\">\n      Max Points\n    </label><input id=\"input-anoncb8f93264f89a225e3f8128b280cecbb\" type=\"number\" name=\"input-anoncb8f93264f89a225e3f8128b280cecbb\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anoncb8f93264f89a225e3f8128b280cecbb\" data-this=\"{&quot;valueId&quot;:&quot;anoncb8f93264f89a225e3f8128b280cecbb&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon3cef7ab98f493b78d355bb9c4f0cb768&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonc95a8519fdf5838c729047f36c09e25d&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div></div></div></div>"
      },
      "output_type" : "execute_result",
      "execution_count" : 9
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Import Some Stuff **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "import java.io.File\nimport scala.collection.JavaConverters._\nimport org.apache.spark.sql._\nimport org.apache.spark.graphx._\nimport scala.util.hashing.MurmurHash3",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "import java.io.File\nimport scala.collection.JavaConverters._\nimport org.apache.spark.sql._\nimport org.apache.spark.graphx._\nimport scala.util.hashing.MurmurHash3\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 10
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Which Congress? **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "val congress = 114",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "congress: Int = 114\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "114"
      },
      "output_type" : "execute_result",
      "execution_count" : 11
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Create a Spark SQL Context **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "val sqlContext = new SQLContext(sparkContext)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "sqlContext: org.apache.spark.sql.SQLContext = org.apache.spark.sql.SQLContext@385bf1a4\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "org.apache.spark.sql.SQLContext@385bf1a4"
      },
      "output_type" : "execute_result",
      "execution_count" : 12
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Read All of the Bills into a Spark DataFrame (Table) and Count Them **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "val allBills = sqlContext.read.json(s\"\"\"/Users/wamplers/govtrackdata/congress/$congress/bills/hr_and_s_bills\"\"\")\nallBills.count",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "allBills: org.apache.spark.sql.DataFrame = [actions: array<struct<acted_at:string,bill_ids:array<string>,calendar:string,committee:string,committees:array<string>,congress:string,how:string,in_committee:string,in_subcommittee:string,law:string,number:string,references:array<struct<reference:string,type:string>>,result:string,roll:string,status:string,suspension:boolean,text:string,type:string,under:string,vote_type:string,where:string>>, amendments: array<struct<amendment_id:string,amendment_type:string,chamber:string,number:string>>, bill_id: string, bill_type: string, by_request: boolean, committees: array<struct<activity:array<string>,committee:string,committee_id:string,subcommittee:string,subcommittee_id:string>>, congress: string, cosponsors: array<struct<district:string,name:stri..."
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "6816"
      },
      "output_type" : "execute_result",
      "execution_count" : 13
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Print the Bill DataFrame's Schema **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "allBills.printSchema()",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "root\n |-- actions: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- acted_at: string (nullable = true)\n |    |    |-- bill_ids: array (nullable = true)\n |    |    |    |-- element: string (containsNull = true)\n |    |    |-- calendar: string (nullable = true)\n |    |    |-- committee: string (nullable = true)\n |    |    |-- committees: array (nullable = true)\n |    |    |    |-- element: string (containsNull = true)\n |    |    |-- congress: string (nullable = true)\n |    |    |-- how: string (nullable = true)\n |    |    |-- in_committee: string (nullable = true)\n |    |    |-- in_subcommittee: string (nullable = true)\n |    |    |-- law: string (nullable = true)\n |    |    |-- number: string (nullable = true)\n |    |    |-- references: array (nullable = true)\n |    |    |    |-- element: struct (containsNull = true)\n |    |    |    |    |-- reference: string (nullable = true)\n |    |    |    |    |-- type: string (nullable = true)\n |    |    |-- result: string (nullable = true)\n |    |    |-- roll: string (nullable = true)\n |    |    |-- status: string (nullable = true)\n |    |    |-- suspension: boolean (nullable = true)\n |    |    |-- text: string (nullable = true)\n |    |    |-- type: string (nullable = true)\n |    |    |-- under: string (nullable = true)\n |    |    |-- vote_type: string (nullable = true)\n |    |    |-- where: string (nullable = true)\n |-- amendments: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- amendment_id: string (nullable = true)\n |    |    |-- amendment_type: string (nullable = true)\n |    |    |-- chamber: string (nullable = true)\n |    |    |-- number: string (nullable = true)\n |-- bill_id: string (nullable = true)\n |-- bill_type: string (nullable = true)\n |-- by_request: boolean (nullable = true)\n |-- committees: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- activity: array (nullable = true)\n |    |    |    |-- element: string (containsNull = true)\n |    |    |-- committee: string (nullable = true)\n |    |    |-- committee_id: string (nullable = true)\n |    |    |-- subcommittee: string (nullable = true)\n |    |    |-- subcommittee_id: string (nullable = true)\n |-- congress: string (nullable = true)\n |-- cosponsors: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- district: string (nullable = true)\n |    |    |-- name: string (nullable = true)\n |    |    |-- sponsored_at: string (nullable = true)\n |    |    |-- state: string (nullable = true)\n |    |    |-- thomas_id: string (nullable = true)\n |    |    |-- title: string (nullable = true)\n |    |    |-- withdrawn_at: string (nullable = true)\n |-- enacted_as: struct (nullable = true)\n |    |-- congress: string (nullable = true)\n |    |-- law_type: string (nullable = true)\n |    |-- number: string (nullable = true)\n |-- history: struct (nullable = true)\n |    |-- active: boolean (nullable = true)\n |    |-- active_at: string (nullable = true)\n |    |-- awaiting_signature: boolean (nullable = true)\n |    |-- enacted: boolean (nullable = true)\n |    |-- enacted_at: string (nullable = true)\n |    |-- house_passage_result: string (nullable = true)\n |    |-- house_passage_result_at: string (nullable = true)\n |    |-- senate_cloture_result: string (nullable = true)\n |    |-- senate_cloture_result_at: string (nullable = true)\n |    |-- senate_override_result: string (nullable = true)\n |    |-- senate_override_result_at: string (nullable = true)\n |    |-- senate_passage_result: string (nullable = true)\n |    |-- senate_passage_result_at: string (nullable = true)\n |    |-- vetoed: boolean (nullable = true)\n |    |-- vetoed_at: string (nullable = true)\n |-- introduced_at: string (nullable = true)\n |-- number: string (nullable = true)\n |-- official_title: string (nullable = true)\n |-- popular_title: string (nullable = true)\n |-- related_bills: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- bill_id: string (nullable = true)\n |    |    |-- reason: string (nullable = true)\n |    |    |-- type: string (nullable = true)\n |-- short_title: string (nullable = true)\n |-- sponsor: struct (nullable = true)\n |    |-- district: string (nullable = true)\n |    |-- name: string (nullable = true)\n |    |-- state: string (nullable = true)\n |    |-- thomas_id: string (nullable = true)\n |    |-- title: string (nullable = true)\n |    |-- type: string (nullable = true)\n |-- status: string (nullable = true)\n |-- status_at: string (nullable = true)\n |-- subjects: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- subjects_top_term: string (nullable = true)\n |-- summary: struct (nullable = true)\n |    |-- as: string (nullable = true)\n |    |-- date: string (nullable = true)\n |    |-- text: string (nullable = true)\n |-- titles: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- as: string (nullable = true)\n |    |    |-- is_for_portion: boolean (nullable = true)\n |    |    |-- title: string (nullable = true)\n |    |    |-- type: string (nullable = true)\n |-- updated_at: string (nullable = true)\n |-- url: string (nullable = true)\n\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 14
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Register the bills DataFrame as table so I can query it with SQL later on ... **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "allBills.registerTempTable(\"all_bills\")",
    "outputs" : [ {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 15
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Define a \"Legislator\" Case Class for Use Later **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "case class Legislator(\n  thomasId: Long,\n  maybeName: Option[String] = None, \n  maybeDOB: Option[String] = None, \n  maybeGender: Option[String] = None, \n  maybeSenOrRep: Option[String] = None, \n  maybeState: Option[String] = None, \n  maybeDistrict: Option[String] = None, \n  maybeParty: Option[String] = None\n) {\n  val name = maybeName.getOrElse(\"?\")\n  val dob = maybeDOB.getOrElse(\"?\")\n  val gender = maybeGender.getOrElse(\"?\")\n  val senOrRep = maybeSenOrRep.getOrElse(\"?\")\n  val state = maybeState.getOrElse(\"?\")\n  val district = maybeDistrict.getOrElse(\"\")\n  val party = maybeParty.getOrElse(\"?\")\n  \n  val isSenator = senOrRep == \"sen\"\n  val isRep     = senOrRep == \"rep\"\n  \n  override def toString: String = s\"$name, $party, $senOrRep, $state, $gender, $dob, $thomasId\"\n}\n\nobject Legislator { \n  def apply(row: Row): Legislator = {\n    val valuesMap = row.getValuesMap[String](List(\"last_name\", \"first_name\", \"birthday\", \"gender\", \"type\", \"state\", \"district\", \"party\", \"thomas_id\"))\n    \n    val maybeFirstName: Option[String] = valuesMap.get(\"first_name\")\n    val maybeLastName: Option[String]  = valuesMap.get(\"last_name\")\n    val maybeName: Option[String] = maybeLastName.map(lastName => \n      maybeFirstName.map(firstName => Some(lastName + \", \" + firstName)).getOrElse(maybeLastName)\n    ).getOrElse(maybeFirstName)\n    \n    Legislator(\n      thomasId = valuesMap.get(\"thomas_id\").map(_.toLong).getOrElse(throw new RuntimeException(\"no thomas id\")),\n      maybeName = maybeName,\n      maybeDOB = valuesMap.get(\"birthday\"),\n      maybeGender = valuesMap.get(\"gender\"),\n      maybeSenOrRep = valuesMap.get(\"type\").map(_.toLowerCase), \n      maybeState = valuesMap.get(\"state\"),\n      maybeDistrict = valuesMap.get(\"district\"), \n      maybeParty = valuesMap.get(\"party\")\n    )\n  }\n}",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "defined class Legislator\ndefined object Legislator\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "$line23.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$Legislator$@67c191d7"
      },
      "output_type" : "execute_result",
      "execution_count" : 16
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Define a \"Bill\" Case Class for Use Later **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "case class Bill(\n  id: Long,\n  billId: String,\n  billType: String,\n  status: String,\n  officialTitle: String,\n  sponsorThomasId: Int,\n  cosponsorThomasIds: List[Int]\n) {\n  def isSenateBill = billType == \"s\"\n  def isHouseBill  = billType == \"hr\"\n  def isEnacted    = status.startsWith(\"ENACTED\")\n}\n\nobject Bill {\n  def apply(row: Row): Bill = {\n    val billId = row.getString(0)\n    val billType = row.getString(1).toLowerCase\n    val status = row.getString(2)\n    val officialTitle = row.getString(3)\n    val sponsorThomasId = row.getStruct(4).getString(3).toInt\n    val cosponsorThomasIds = row.getList(5).toArray.toList.map(item => item.asInstanceOf[Row].getString(4).toInt)\n    \n    Bill(\n      id = MurmurHash3.stringHash(billId),\n      billId = billId,\n      billType = billType,\n      status = status,\n      officialTitle = officialTitle,\n      sponsorThomasId = sponsorThomasId,\n      cosponsorThomasIds = cosponsorThomasIds\n    )\n  }\n}",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "defined class Bill\ndefined object Bill\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "$line24.$read$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$$iw$Bill$@4651799c"
      },
      "output_type" : "execute_result",
      "execution_count" : 17
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Convert the Bills DataFrame (Table) into an RDD of Bill Objects **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "val bills = sqlContext.\n  sql(\"SELECT bill_id, bill_type, status, official_title, sponsor, cosponsors FROM all_bills\").\n  map(row => Bill(row))\nbills.count",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "bills: org.apache.spark.rdd.RDD[Bill] = MapPartitionsRDD[19] at map at <console>:74\nres7: Long = 6816\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "6816"
      },
      "output_type" : "execute_result",
      "execution_count" : 18
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Bills have a \"status\" field indicating where they are in the legislative process: **\n\nMost Bills are \"REFERRED\" to a committee (and never come out).\n\nOthers are \"ENACTED\" meaning they have passed both the house and senate."
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Counts by Bill Status **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "bills.groupBy(_.status).map{ case (status, lst) => (status, lst.size) }.collect()",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "res8: Array[(String, Int)] = Array((PASS_OVER:HOUSE,248), (PROV_KILL:VETO,2), (PROV_KILL:SUSPENSIONFAILED,2), (REFERRED,5971), (PASSED:BILL,3), (PROV_KILL:CLOTUREFAILED,9), (REPORTED,405), (FAIL:ORIGINATING:HOUSE,1), (PASS_BACK:SENATE,4), (CONFERENCE:PASSED:HOUSE,1), (PASS_OVER:SENATE,57), (ENACTED:SIGNED,112), (VETOED:OVERRIDE_FAIL_ORIGINATING:SENATE,1))\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "<div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon036dc85c84304ada732346d8d905f1db&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;PASS_OVER:HOUSE&quot;,&quot;_2&quot;:248},{&quot;_1&quot;:&quot;PROV_KILL:VETO&quot;,&quot;_2&quot;:2},{&quot;_1&quot;:&quot;PROV_KILL:SUSPENSIONFAILED&quot;,&quot;_2&quot;:2},{&quot;_1&quot;:&quot;REFERRED&quot;,&quot;_2&quot;:5971},{&quot;_1&quot;:&quot;PASSED:BILL&quot;,&quot;_2&quot;:3},{&quot;_1&quot;:&quot;PROV_KILL:CLOTUREFAILED&quot;,&quot;_2&quot;:9},{&quot;_1&quot;:&quot;REPORTED&quot;,&quot;_2&quot;:405},{&quot;_1&quot;:&quot;FAIL:ORIGINATING:HOUSE&quot;,&quot;_2&quot;:1},{&quot;_1&quot;:&quot;PASS_BACK:SENATE&quot;,&quot;_2&quot;:4},{&quot;_1&quot;:&quot;CONFERENCE:PASSED:HOUSE&quot;,&quot;_2&quot;:1},{&quot;_1&quot;:&quot;PASS_OVER:SENATE&quot;,&quot;_2&quot;:57},{&quot;_1&quot;:&quot;ENACTED:SIGNED&quot;,&quot;_2&quot;:112},{&quot;_1&quot;:&quot;VETOED:OVERRIDE_FAIL_ORIGINATING:SENATE&quot;,&quot;_2&quot;:1}],&quot;genId&quot;:&quot;295550593&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tabs'], \n      function(playground, _magictabs) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictabs,\n    \"o\": {}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon803ac69e9e603f21b7f71a6e79fc89df\">\n      Max Points (controlling all tabs)\n    </label><input id=\"input-anon803ac69e9e603f21b7f71a6e79fc89df\" type=\"number\" name=\"input-anon803ac69e9e603f21b7f71a6e79fc89df\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon803ac69e9e603f21b7f71a6e79fc89df\" data-this=\"{&quot;valueId&quot;:&quot;anon803ac69e9e603f21b7f71a6e79fc89df&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <div>\n          <ul class=\"nav nav-tabs\" id=\"ul295550593\"><li>\n                <a href=\"#tab295550593-0\"><i class=\"fa fa-table\"/></a>\n              </li><li>\n                <a href=\"#tab295550593-1\"><i class=\"fa fa-bar-chart\"/></a>\n              </li><li>\n                <a href=\"#tab295550593-2\"><i class=\"fa fa-pie-chart\"/></a>\n              </li></ul>\n\n          <div class=\"tab-content\" id=\"tab295550593\"><div class=\"tab-pane\" id=\"tab295550593-0\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anone63d3550b7727235755cbb07402e1950&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;PASS_OVER:HOUSE&quot;,&quot;_2&quot;:248},{&quot;_1&quot;:&quot;PROV_KILL:VETO&quot;,&quot;_2&quot;:2},{&quot;_1&quot;:&quot;PROV_KILL:SUSPENSIONFAILED&quot;,&quot;_2&quot;:2},{&quot;_1&quot;:&quot;REFERRED&quot;,&quot;_2&quot;:5971},{&quot;_1&quot;:&quot;PASSED:BILL&quot;,&quot;_2&quot;:3},{&quot;_1&quot;:&quot;PROV_KILL:CLOTUREFAILED&quot;,&quot;_2&quot;:9},{&quot;_1&quot;:&quot;REPORTED&quot;,&quot;_2&quot;:405},{&quot;_1&quot;:&quot;FAIL:ORIGINATING:HOUSE&quot;,&quot;_2&quot;:1},{&quot;_1&quot;:&quot;PASS_BACK:SENATE&quot;,&quot;_2&quot;:4},{&quot;_1&quot;:&quot;CONFERENCE:PASSED:HOUSE&quot;,&quot;_2&quot;:1},{&quot;_1&quot;:&quot;PASS_OVER:SENATE&quot;,&quot;_2&quot;:57},{&quot;_1&quot;:&quot;ENACTED:SIGNED&quot;,&quot;_2&quot;:112},{&quot;_1&quot;:&quot;VETOED:OVERRIDE_FAIL_ORIGINATING:SENATE&quot;,&quot;_2&quot;:1}],&quot;genId&quot;:&quot;1099406302&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tableChart'], \n      function(playground, _magictableChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictableChart,\n    \"o\": {\"headers\":[\"_1\",\"_2\"],\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anone1e988373430b3a971fe539f1a5a87bb\">\n      Max Points\n    </label><input id=\"input-anone1e988373430b3a971fe539f1a5a87bb\" type=\"number\" name=\"input-anone1e988373430b3a971fe539f1a5a87bb\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anone1e988373430b3a971fe539f1a5a87bb\" data-this=\"{&quot;valueId&quot;:&quot;anone1e988373430b3a971fe539f1a5a87bb&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anona53458e4e313eac0ed14f66a77d319a4&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonbb24c9d09b66a6569f65d327e7bec65b&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab295550593-1\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anonff5af0048dfb166e4020a18ea381f9bc&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;PASS_OVER:HOUSE&quot;,&quot;_2&quot;:248},{&quot;_1&quot;:&quot;PROV_KILL:VETO&quot;,&quot;_2&quot;:2},{&quot;_1&quot;:&quot;PROV_KILL:SUSPENSIONFAILED&quot;,&quot;_2&quot;:2},{&quot;_1&quot;:&quot;REFERRED&quot;,&quot;_2&quot;:5971},{&quot;_1&quot;:&quot;PASSED:BILL&quot;,&quot;_2&quot;:3},{&quot;_1&quot;:&quot;PROV_KILL:CLOTUREFAILED&quot;,&quot;_2&quot;:9},{&quot;_1&quot;:&quot;REPORTED&quot;,&quot;_2&quot;:405},{&quot;_1&quot;:&quot;FAIL:ORIGINATING:HOUSE&quot;,&quot;_2&quot;:1},{&quot;_1&quot;:&quot;PASS_BACK:SENATE&quot;,&quot;_2&quot;:4},{&quot;_1&quot;:&quot;CONFERENCE:PASSED:HOUSE&quot;,&quot;_2&quot;:1},{&quot;_1&quot;:&quot;PASS_OVER:SENATE&quot;,&quot;_2&quot;:57},{&quot;_1&quot;:&quot;ENACTED:SIGNED&quot;,&quot;_2&quot;:112},{&quot;_1&quot;:&quot;VETOED:OVERRIDE_FAIL_ORIGINATING:SENATE&quot;,&quot;_2&quot;:1}],&quot;genId&quot;:&quot;405891296&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/barChart'], \n      function(playground, _magicbarChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicbarChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anonc8595252c76cfe21cf278c8f58f513d2\">\n      Max Points\n    </label><input id=\"input-anonc8595252c76cfe21cf278c8f58f513d2\" type=\"number\" name=\"input-anonc8595252c76cfe21cf278c8f58f513d2\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anonc8595252c76cfe21cf278c8f58f513d2\" data-this=\"{&quot;valueId&quot;:&quot;anonc8595252c76cfe21cf278c8f58f513d2&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon8578fd3c3c83fc29c32fb48e254a1c91&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon41e3c3b46385bfc4c849177c0a6c150c&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab295550593-2\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anond7a645ca3bb8e22bd3c36d6041719ad2&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;PASS_OVER:HOUSE&quot;,&quot;_2&quot;:248},{&quot;_1&quot;:&quot;PROV_KILL:VETO&quot;,&quot;_2&quot;:2},{&quot;_1&quot;:&quot;PROV_KILL:SUSPENSIONFAILED&quot;,&quot;_2&quot;:2},{&quot;_1&quot;:&quot;REFERRED&quot;,&quot;_2&quot;:5971},{&quot;_1&quot;:&quot;PASSED:BILL&quot;,&quot;_2&quot;:3},{&quot;_1&quot;:&quot;PROV_KILL:CLOTUREFAILED&quot;,&quot;_2&quot;:9},{&quot;_1&quot;:&quot;REPORTED&quot;,&quot;_2&quot;:405},{&quot;_1&quot;:&quot;FAIL:ORIGINATING:HOUSE&quot;,&quot;_2&quot;:1},{&quot;_1&quot;:&quot;PASS_BACK:SENATE&quot;,&quot;_2&quot;:4},{&quot;_1&quot;:&quot;CONFERENCE:PASSED:HOUSE&quot;,&quot;_2&quot;:1},{&quot;_1&quot;:&quot;PASS_OVER:SENATE&quot;,&quot;_2&quot;:57},{&quot;_1&quot;:&quot;ENACTED:SIGNED&quot;,&quot;_2&quot;:112},{&quot;_1&quot;:&quot;VETOED:OVERRIDE_FAIL_ORIGINATING:SENATE&quot;,&quot;_2&quot;:1}],&quot;genId&quot;:&quot;516528050&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/pieChart'], \n      function(playground, _magicpieChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicpieChart,\n    \"o\": {\"series\":\"_1\",\"p\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon3c91d5cc113d38a33d037c1115b8ad04\">\n      Max Points\n    </label><input id=\"input-anon3c91d5cc113d38a33d037c1115b8ad04\" type=\"number\" name=\"input-anon3c91d5cc113d38a33d037c1115b8ad04\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon3c91d5cc113d38a33d037c1115b8ad04\" data-this=\"{&quot;valueId&quot;:&quot;anon3c91d5cc113d38a33d037c1115b8ad04&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonb0ad83924efe123b02a059e7f72f408d&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon02a6b1400137615d791de2815f878362&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div></div>\n        </div>\n      </div></div>"
      },
      "output_type" : "execute_result",
      "execution_count" : 19
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Number of Enacted Bills by House **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "bills.filter(_.isEnacted).groupBy(_.billType).map { case (billType, lst) => (billType, lst.size) }.collect()",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "res9: Array[(String, Int)] = Array((hr,75), (s,37))\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "<div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon49bb053d2c3ef5cd158bb664eabfd6ca&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;hr&quot;,&quot;_2&quot;:75},{&quot;_1&quot;:&quot;s&quot;,&quot;_2&quot;:37}],&quot;genId&quot;:&quot;508414257&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tabs'], \n      function(playground, _magictabs) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictabs,\n    \"o\": {}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon0749410986e8f5710aa300c244ecd586\">\n      Max Points (controlling all tabs)\n    </label><input id=\"input-anon0749410986e8f5710aa300c244ecd586\" type=\"number\" name=\"input-anon0749410986e8f5710aa300c244ecd586\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon0749410986e8f5710aa300c244ecd586\" data-this=\"{&quot;valueId&quot;:&quot;anon0749410986e8f5710aa300c244ecd586&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <div>\n          <ul class=\"nav nav-tabs\" id=\"ul508414257\"><li>\n                <a href=\"#tab508414257-0\"><i class=\"fa fa-table\"/></a>\n              </li><li>\n                <a href=\"#tab508414257-1\"><i class=\"fa fa-bar-chart\"/></a>\n              </li><li>\n                <a href=\"#tab508414257-2\"><i class=\"fa fa-pie-chart\"/></a>\n              </li></ul>\n\n          <div class=\"tab-content\" id=\"tab508414257\"><div class=\"tab-pane\" id=\"tab508414257-0\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anonb2fab23e630a52126fc2101c6c16abca&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;hr&quot;,&quot;_2&quot;:75},{&quot;_1&quot;:&quot;s&quot;,&quot;_2&quot;:37}],&quot;genId&quot;:&quot;467833744&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tableChart'], \n      function(playground, _magictableChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictableChart,\n    \"o\": {\"headers\":[\"_1\",\"_2\"],\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anonacb0db2a024a1132e2e38a2058ac9785\">\n      Max Points\n    </label><input id=\"input-anonacb0db2a024a1132e2e38a2058ac9785\" type=\"number\" name=\"input-anonacb0db2a024a1132e2e38a2058ac9785\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anonacb0db2a024a1132e2e38a2058ac9785\" data-this=\"{&quot;valueId&quot;:&quot;anonacb0db2a024a1132e2e38a2058ac9785&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon16afe2f7c8d6407179c2d1bbb893b2c8&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon9d38da188e162571ba8d37a0f23c8b3e&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab508414257-1\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anonc94737def6711a82ca4c3ddf9276bde8&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;hr&quot;,&quot;_2&quot;:75},{&quot;_1&quot;:&quot;s&quot;,&quot;_2&quot;:37}],&quot;genId&quot;:&quot;905420786&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/barChart'], \n      function(playground, _magicbarChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicbarChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon8a2250496d2589fec21e8fd7245c8705\">\n      Max Points\n    </label><input id=\"input-anon8a2250496d2589fec21e8fd7245c8705\" type=\"number\" name=\"input-anon8a2250496d2589fec21e8fd7245c8705\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon8a2250496d2589fec21e8fd7245c8705\" data-this=\"{&quot;valueId&quot;:&quot;anon8a2250496d2589fec21e8fd7245c8705&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon08cba902703d46a29418b5d5b72656b6&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon22f68503fb719851b8987d7b4aa1307f&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab508414257-2\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon42980dad48017031d055ec2d3fddd9c5&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;hr&quot;,&quot;_2&quot;:75},{&quot;_1&quot;:&quot;s&quot;,&quot;_2&quot;:37}],&quot;genId&quot;:&quot;1864067961&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/pieChart'], \n      function(playground, _magicpieChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicpieChart,\n    \"o\": {\"series\":\"_1\",\"p\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon1b7525f65a4fc1c0d32a33432ffff14b\">\n      Max Points\n    </label><input id=\"input-anon1b7525f65a4fc1c0d32a33432ffff14b\" type=\"number\" name=\"input-anon1b7525f65a4fc1c0d32a33432ffff14b\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon1b7525f65a4fc1c0d32a33432ffff14b\" data-this=\"{&quot;valueId&quot;:&quot;anon1b7525f65a4fc1c0d32a33432ffff14b&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anona101fca05764a7e7964d417c20e5d4f0&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon0d5a1de4442a754ffe06cc8601d8dcd3&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div></div>\n        </div>\n      </div></div>"
      },
      "output_type" : "execute_result",
      "execution_count" : 20
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Read the List of Current Legislators into a Spark DataFrame **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "val legislatorsDF = sqlContext.\n  read.\n  format(\"com.databricks.spark.csv\").\n  option(\"header\", \"true\").\n  load(\"/Users/wamplers/govtrackdata/congress-legislators/legislators-current.csv\")",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "legislatorsDF: org.apache.spark.sql.DataFrame = [last_name: string, first_name: string, birthday: string, gender: string, type: string, state: string, district: string, party: string, url: string, address: string, phone: string, contact_form: string, rss_url: string, twitter: string, facebook: string, facebook_id: string, youtube: string, youtube_id: string, bioguide_id: string, thomas_id: string, opensecrets_id: string, lis_id: string, cspan_id: string, govtrack_id: string, votesmart_id: string, ballotpedia_id: string, washington_post_id: string, icpsr_id: string, wikipedia_id: string]\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "<span style=\"color:red;\">Ooops, exception in the cell: </span>"
      },
      "output_type" : "execute_result",
      "execution_count" : 21
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Here's one: **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "legislatorsDF.take(1).foreach(println)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "[Brown,Sherrod,1952-11-09,M,sen,OH,,Democrat,http://www.brown.senate.gov,713 Hart Senate Office Building Washington DC 20510,202-224-2315,http://www.brown.senate.gov/contact,http://www.brown.senate.gov/rss/feeds/?type=all&amp;,SenSherrodBrown,,,SherrodBrownOhio,UCgy8jfERh-t_ixkKKoCmglQ,B000944,00136,N00003535,S307,5051,400050,27018,Sherrod Brown,gIQA3O2w9O,29389,Sherrod Brown]\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 22
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Congressmen each have a \"thomas_id\" that I'll be using later. **"
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Convert the Legislator DataFrame into an RDD of Legislator Instances **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "// convert the legislators in the DataFrame to an RDD of Legislator objects\nval legislators = legislatorsDF.\n  map(row => Legislator(row))\n\n// name the legislators DF so it can be used in SQL queries later\nlegislatorsDF.registerTempTable(\"legislators\") \n\n// count them\nlegislators.count",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "legislators: org.apache.spark.rdd.RDD[Legislator] = MapPartitionsRDD[41] at map at <console>:75\nres11: Long = 540\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "540"
      },
      "output_type" : "execute_result",
      "execution_count" : 23
    } ]
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "legislators.take(5).foreach(println)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "Brown, Sherrod, Democrat, sen, OH, M, 1952-11-09, 136\nCantwell, Maria, Democrat, sen, WA, F, 1958-10-13, 172\nCardin, Benjamin, Democrat, sen, MD, M, 1943-10-05, 174\nCarper, Thomas, Democrat, sen, DE, M, 1947-01-23, 179\nCasey, Robert, Democrat, sen, PA, M, 1960-04-13, 1828\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 24
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Get the List of Senators **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "val senators = legislators.filter(_.isSenator)\n\nsenators.count",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "senators: org.apache.spark.rdd.RDD[Legislator] = MapPartitionsRDD[42] at filter at <console>:74\nres13: Long = 100\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "100"
      },
      "output_type" : "execute_result",
      "execution_count" : 25
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Count the Senators by Party **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "senators.groupBy(_.party).map{ case (party, lst) => (party, lst.size) }.collect()",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "res14: Array[(String, Int)] = Array((Independent,2), (Republican,54), (Democrat,44))\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "<div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anoncfdb1b0d0aec24de62f9fe560b69abea&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;Independent&quot;,&quot;_2&quot;:2},{&quot;_1&quot;:&quot;Republican&quot;,&quot;_2&quot;:54},{&quot;_1&quot;:&quot;Democrat&quot;,&quot;_2&quot;:44}],&quot;genId&quot;:&quot;699186992&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tabs'], \n      function(playground, _magictabs) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictabs,\n    \"o\": {}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anonb06f89e2e178ec5dabd4bdca41c1a26e\">\n      Max Points (controlling all tabs)\n    </label><input id=\"input-anonb06f89e2e178ec5dabd4bdca41c1a26e\" type=\"number\" name=\"input-anonb06f89e2e178ec5dabd4bdca41c1a26e\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anonb06f89e2e178ec5dabd4bdca41c1a26e\" data-this=\"{&quot;valueId&quot;:&quot;anonb06f89e2e178ec5dabd4bdca41c1a26e&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <div>\n          <ul class=\"nav nav-tabs\" id=\"ul699186992\"><li>\n                <a href=\"#tab699186992-0\"><i class=\"fa fa-table\"/></a>\n              </li><li>\n                <a href=\"#tab699186992-1\"><i class=\"fa fa-bar-chart\"/></a>\n              </li><li>\n                <a href=\"#tab699186992-2\"><i class=\"fa fa-pie-chart\"/></a>\n              </li></ul>\n\n          <div class=\"tab-content\" id=\"tab699186992\"><div class=\"tab-pane\" id=\"tab699186992-0\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon118f4357902d68ae3c14470bbbd41c1d&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;Independent&quot;,&quot;_2&quot;:2},{&quot;_1&quot;:&quot;Republican&quot;,&quot;_2&quot;:54},{&quot;_1&quot;:&quot;Democrat&quot;,&quot;_2&quot;:44}],&quot;genId&quot;:&quot;54631769&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tableChart'], \n      function(playground, _magictableChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictableChart,\n    \"o\": {\"headers\":[\"_1\",\"_2\"],\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon608736283536d379800917436832cb6b\">\n      Max Points\n    </label><input id=\"input-anon608736283536d379800917436832cb6b\" type=\"number\" name=\"input-anon608736283536d379800917436832cb6b\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon608736283536d379800917436832cb6b\" data-this=\"{&quot;valueId&quot;:&quot;anon608736283536d379800917436832cb6b&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon3efa8d199f0ba1b4cff42422d9306a5b&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonc767ee150bfbfb60f3bfc1cabf7eeb9e&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab699186992-1\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anonb2f63f659472b5cebec047ff919f8009&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;Independent&quot;,&quot;_2&quot;:2},{&quot;_1&quot;:&quot;Republican&quot;,&quot;_2&quot;:54},{&quot;_1&quot;:&quot;Democrat&quot;,&quot;_2&quot;:44}],&quot;genId&quot;:&quot;334368720&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/barChart'], \n      function(playground, _magicbarChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicbarChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anond1852f3a250097d0b31fbbe2252fd1fc\">\n      Max Points\n    </label><input id=\"input-anond1852f3a250097d0b31fbbe2252fd1fc\" type=\"number\" name=\"input-anond1852f3a250097d0b31fbbe2252fd1fc\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anond1852f3a250097d0b31fbbe2252fd1fc\" data-this=\"{&quot;valueId&quot;:&quot;anond1852f3a250097d0b31fbbe2252fd1fc&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon14ee14e556820712eddc421dc6351988&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon16f862a5b0f77ee57a7a50bd86244057&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab699186992-2\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anonc7570dcc645ec4624972a3551f561c94&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;Independent&quot;,&quot;_2&quot;:2},{&quot;_1&quot;:&quot;Republican&quot;,&quot;_2&quot;:54},{&quot;_1&quot;:&quot;Democrat&quot;,&quot;_2&quot;:44}],&quot;genId&quot;:&quot;1146796943&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/pieChart'], \n      function(playground, _magicpieChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicpieChart,\n    \"o\": {\"series\":\"_1\",\"p\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon93629d033264bed571b2dae4c5d6eae7\">\n      Max Points\n    </label><input id=\"input-anon93629d033264bed571b2dae4c5d6eae7\" type=\"number\" name=\"input-anon93629d033264bed571b2dae4c5d6eae7\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon93629d033264bed571b2dae4c5d6eae7\" data-this=\"{&quot;valueId&quot;:&quot;anon93629d033264bed571b2dae4c5d6eae7&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anoneed65d549ef48cbcbb37ac60c5fc96d3&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonbd4bebf76fdcc23cdb82725af8867281&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div></div>\n        </div>\n      </div></div>"
      },
      "output_type" : "execute_result",
      "execution_count" : 26
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Count the Senators by Gender **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "senators.groupBy(_.gender).map{ case (gender, lst) => (gender, lst.size) }.collect()",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "res15: Array[(String, Int)] = Array((F,20), (M,80))\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "<div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon03f450a251629d6fe266487c8bacf488&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;F&quot;,&quot;_2&quot;:20},{&quot;_1&quot;:&quot;M&quot;,&quot;_2&quot;:80}],&quot;genId&quot;:&quot;1053436300&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tabs'], \n      function(playground, _magictabs) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictabs,\n    \"o\": {}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon692cddfc60e08c347c01e1ba00bc554b\">\n      Max Points (controlling all tabs)\n    </label><input id=\"input-anon692cddfc60e08c347c01e1ba00bc554b\" type=\"number\" name=\"input-anon692cddfc60e08c347c01e1ba00bc554b\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon692cddfc60e08c347c01e1ba00bc554b\" data-this=\"{&quot;valueId&quot;:&quot;anon692cddfc60e08c347c01e1ba00bc554b&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <div>\n          <ul class=\"nav nav-tabs\" id=\"ul1053436300\"><li>\n                <a href=\"#tab1053436300-0\"><i class=\"fa fa-table\"/></a>\n              </li><li>\n                <a href=\"#tab1053436300-1\"><i class=\"fa fa-bar-chart\"/></a>\n              </li><li>\n                <a href=\"#tab1053436300-2\"><i class=\"fa fa-pie-chart\"/></a>\n              </li></ul>\n\n          <div class=\"tab-content\" id=\"tab1053436300\"><div class=\"tab-pane\" id=\"tab1053436300-0\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon52ce4f2ab8757891b3b1507ebdcd544c&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;F&quot;,&quot;_2&quot;:20},{&quot;_1&quot;:&quot;M&quot;,&quot;_2&quot;:80}],&quot;genId&quot;:&quot;1568244431&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tableChart'], \n      function(playground, _magictableChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictableChart,\n    \"o\": {\"headers\":[\"_1\",\"_2\"],\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon74b12bf20fa04df1bd9f53fadc487725\">\n      Max Points\n    </label><input id=\"input-anon74b12bf20fa04df1bd9f53fadc487725\" type=\"number\" name=\"input-anon74b12bf20fa04df1bd9f53fadc487725\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon74b12bf20fa04df1bd9f53fadc487725\" data-this=\"{&quot;valueId&quot;:&quot;anon74b12bf20fa04df1bd9f53fadc487725&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon13e20add7d728eeba5604135ff25928e&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon68e0d52a5a2db6fa2828ac16ecfc5414&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab1053436300-1\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anonf2dea7fc8d34ef626ac8bf71b0c2e52e&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;F&quot;,&quot;_2&quot;:20},{&quot;_1&quot;:&quot;M&quot;,&quot;_2&quot;:80}],&quot;genId&quot;:&quot;1485914880&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/barChart'], \n      function(playground, _magicbarChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicbarChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anone1c691ee22b00087d841743988aea959\">\n      Max Points\n    </label><input id=\"input-anone1c691ee22b00087d841743988aea959\" type=\"number\" name=\"input-anone1c691ee22b00087d841743988aea959\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anone1c691ee22b00087d841743988aea959\" data-this=\"{&quot;valueId&quot;:&quot;anone1c691ee22b00087d841743988aea959&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon0838a58bda12b8774c1f34ca435ead7f&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon4d9e6e45fdca5039b87c563519a404e3&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab1053436300-2\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon4cb507632fda1e3ff74bbd6475a5e313&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;F&quot;,&quot;_2&quot;:20},{&quot;_1&quot;:&quot;M&quot;,&quot;_2&quot;:80}],&quot;genId&quot;:&quot;2119405093&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/pieChart'], \n      function(playground, _magicpieChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicpieChart,\n    \"o\": {\"series\":\"_1\",\"p\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon1ed846960b6cb18e73e953ee1e8802bd\">\n      Max Points\n    </label><input id=\"input-anon1ed846960b6cb18e73e953ee1e8802bd\" type=\"number\" name=\"input-anon1ed846960b6cb18e73e953ee1e8802bd\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon1ed846960b6cb18e73e953ee1e8802bd\" data-this=\"{&quot;valueId&quot;:&quot;anon1ed846960b6cb18e73e953ee1e8802bd&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anoncc4b75ab52f5aa6806561c13da253376&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon82be2dad6dc7c2c8df049039dd41b59c&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div></div>\n        </div>\n      </div></div>"
      },
      "output_type" : "execute_result",
      "execution_count" : 27
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Get the Bills that Originated in the Senate **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "val senateBills = bills.filter(_.isSenateBill)\n\nsenateBills.count",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "senateBills: org.apache.spark.rdd.RDD[Bill] = MapPartitionsRDD[50] at filter at <console>:74\nres17: Long = 2434\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "2434"
      },
      "output_type" : "execute_result",
      "execution_count" : 30
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Convert the Senate Bills into Edges (co-sponsor -> sponsor) **\n\nEach Edge is directional from a bill's cosponsor to the bill's sponsor."
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "val senateEdges = \n  senateBills.\n  flatMap(bill => bill.cosponsorThomasIds.map(cosponsorId => Edge(cosponsorId, bill.sponsorThomasId, None)))\n\nsenateEdges.count",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "senateEdges: org.apache.spark.rdd.RDD[org.apache.spark.graphx.Edge[None.type]] = MapPartitionsRDD[51] at flatMap at <console>:76\nres18: Long = 12776\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "12776"
      },
      "output_type" : "execute_result",
      "execution_count" : 31
    } ]
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "senateEdges.take(5).foreach(println)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "Edge(153,924,None)\nEdge(452,924,None)\nEdge(1820,924,None)\nEdge(2085,924,None)\nEdge(1965,1998,None)\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 32
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Convert the Senators into Graph Vertices **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "val senateVertices = senators.keyBy(_.thomasId)\n\nsenateVertices.count",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "senateVertices: org.apache.spark.rdd.RDD[(Long, Legislator)] = MapPartitionsRDD[79] at keyBy at <console>:76\nres22: Long = 100\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "100"
      },
      "output_type" : "execute_result",
      "execution_count" : 37
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Create the Senate Graph **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "val senateGraph = Graph(senateVertices, senateEdges)\n\nprintln(s\"Num Edges   : ${senateGraph.numEdges}\")\nprintln(s\"Num Vertices: ${senateGraph.numVertices}\")",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "Num Edges   : 12776\nNum Vertices: 100\nsenateGraph: org.apache.spark.graphx.Graph[Legislator,None.type] = org.apache.spark.graphx.impl.GraphImpl@2fe5b72e\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 38
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Run Page Rank on the senate graph to estimate the influence bill sponsors have on co-sponsors: **\n\nThe output is another graph where the vertices are a the senator ids and page ranks (id -> page-rank).\n\nSee: https://spark.apache.org/docs/1.5.2/graphx-programming-guide.html#pagerank"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "val senatePageRank = senateGraph.ops.pageRank(0.0001)\n\nsenatePageRank.vertices.take(5).foreach(println)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "(1534,2.141766072140464)\n(1010,0.39430804902968125)\n(2076,1.1825944464986369)\n(802,0.6741529189948912)\n(1676,0.5319400894075864)\nsenatePageRank: org.apache.spark.graphx.Graph[Double,Double] = org.apache.spark.graphx.impl.GraphImpl@a13c012\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 41
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Join the Page Rank Vertices (Senator Id and Page Rank) with the Senate Vertices (Senators) **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "senatePageRank.\n  vertices.\n  join(senateVertices).\n  map { case (id, (pageRank, person)) => (person.name, person.party, id, pageRank) }.\n  sortBy(_._4, ascending = false).\n  take(10).\n  foreach(println)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "(Grassley, Charles,Republican,457,2.808990168767133)\n(Hatch, Orrin,Republican,1351,2.5081412232163727)\n(Thune, John,Republican,1534,2.141766072140464)\n(Cardin, Benjamin,Democrat,174,1.9820122202876937)\n(Moran, Jerry,Republican,1507,1.9525179592883732)\n(Portman, Robert,Republican,924,1.9489782665009152)\n(Blunt, Roy,Republican,1464,1.939751138809017)\n(Lee, Mike,Republican,2080,1.8962890475999443)\n(Cornyn, John,Republican,1692,1.8933604413943212)\n(Rubio, Marco,Republican,2084,1.8182703984116717)\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 45
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** An Approximation of Page Rank is Vertice In-Degrees **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "val senateInDegrees = senateGraph.ops.inDegrees",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "senateInDegrees: org.apache.spark.graphx.VertexRDD[Int] = VertexRDDImpl[2527] at RDD at VertexRDD.scala:59\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "VertexRDDImpl[2527] at RDD at VertexRDD.scala:59"
      },
      "output_type" : "execute_result",
      "execution_count" : 46
    } ]
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "senateInDegrees.\n  join(senateVertices).\n  map { case (id, (inDegrees, person)) => (person.name, person.party, id, inDegrees) }.\n  sortBy(_._4, ascending = false).\n  take(10).\n  foreach(println)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "(Grassley, Charles,Republican,457,387)\n(Brown, Sherrod,Democrat,136,331)\n(Cardin, Benjamin,Democrat,174,321)\n(Murray, Patty,Democrat,1409,295)\n(Hatch, Orrin,Republican,1351,291)\n(Wyden, Ron,Democrat,1247,276)\n(Feinstein, Dianne,Democrat,1332,272)\n(Moran, Jerry,Republican,1507,260)\n(Thune, John,Republican,1534,258)\n(Blunt, Roy,Republican,1464,245)\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 47
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Grassley's Sponsored Bills: **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "sqlContext.\n  sql(\"\"\"\n  |select\n  |  bill_id,\n  |  sponsor['name'],\n  |  status,\n  |  official_title\n  |from\n  |  all_bills\n  |where\n  |  sponsor['thomas_id'] = 457\n  |\"\"\".stripMargin).\n  foreach(println)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "[s2416-114,Grassley, Chuck,REFERRED,A bill to amend titles XVIII and XIX of the Social Security Act to require the use of electronic visit verification systems for home health services under the Medicare program and personal care services and home health care services under the Medicaid program.]\n[s1648-114,Grassley, Chuck,REFERRED,A bill to amend title XVIII of the Social Security Act to create a sustainable future for rural healthcare.]\n[s2390-114,Grassley, Chuck,REFERRED,A bill to provide adequate protections for whistleblowers at the Federal Bureau of Investigation.]\n[s2353-114,Grassley, Chuck,REFERRED,A bill to amend the Internal Revenue Code of 1986 to extend and modify the incentives for biodiesel.]\n[s1604-114,Grassley, Chuck,REFERRED,A bill to establish the Transition to Independence Medicaid Buy-In Option demonstration program.]\n[s1599-114,Grassley, Chuck,PASS_OVER:SENATE,A bill to provide anti-retaliation protections for antitrust whistleblowers.]\n[s1578-114,Grassley, Chuck,REFERRED,A bill to amend the Internal Revenue Code of 1986 to enhance taxpayer rights, and for other purposes.]\n[s2266-114,Grassley, Chuck,REFERRED,A bill to amend the Immigration and Nationality Act to reform and reduce fraud and abuse in certain visa programs for aliens working temporarily in the United States, and for other purposes.]\n[s2228-114,Grassley, Chuck,REFERRED,A bill to amend title XVIII of the Social Security Act to permit review of certain Medicare payment determinations for disproportionate share hospitals, and for other purposes.]\n[s1482-114,Grassley, Chuck,ENACTED:SIGNED,A bill to improve and reauthorize provisions relating to the application of the antitrust laws to the award of need-based educational aid.]\n[s829-114,Grassley, Chuck,REFERRED,A bill to amend title XVIII of the Social Security Act to refine how Medicare pays for orthotics and prosthetics and to improve beneficiary experience and outcomes with orthotic and prosthetic care, and for other purposes.]\n[s2153-114,Grassley, Chuck,REFERRED,A bill to amend title XI of the Social Security Act to require applicable manufacturers to include information regarding payments made to physician assistants, nurse practitioners, and other advance practice nurses in transparency reports submitted under section 1128G of such Act.]\n[s2150-114,Grassley, Chuck,REFERRED,A bill to amend the Higher Education Act of 1965 to make technical improvements to the Net Price Calculator system so that prospective students may have a more accurate understanding of the true cost of college.]\n[s2149-114,Grassley, Chuck,REFERRED,A bill to amend the Higher Education Opportunity Act to add disclosure requirements to the institution financial aid offer form and to amend the Higher Education Act of 1965 to make such form mandatory.]\n[s1439-114,Grassley, Chuck,REFERRED,A bill to amend part E of title IV of the Social Security Act to allow States that provide foster care for children up to age 21 to serve former foster youths through age 23 under the John H. Chafee Foster Care Independence Program.]\n[s1418-114,Grassley, Chuck,REFERRED,A bill to amend title 28, United States Code, to provide an Inspector General for the judicial branch, and for other purposes.]\n[s783-114,Grassley, Chuck,REFERRED,A bill to provide for media coverage of Federal court proceedings.]\n[s746-114,Grassley, Chuck,REFERRED,A bill to provide for the establishment of a Commission to Accelerate the End of Breast Cancer.]\n[s724-114,Grassley, Chuck,REFERRED,A bill to amend the Controlled Substances Act to provide enhanced penalties for marketing candy-flavored controlled substances to minors.]\n[s704-114,Grassley, Chuck,REPORTED,A bill to establish a Community-Based Institutional Special Needs Plan demonstration program to target home and community-based care to eligible Medicare beneficiaries.]\n[s2123-114,Grassley, Chuck,REPORTED,A bill to reform sentencing laws and correctional institutions, and for other purposes.]\n[s686-114,Grassley, Chuck,REFERRED,A bill to amend the Internal Revenue Code of 1986 to provide a limitation on certain aliens from claiming the earned income tax credit.]\n[s1318-114,Grassley, Chuck,REPORTED,A bill to amend title 18, United States Code, to provide for protection of maritime navigation and prevention of nuclear terrorism, and for other purposes.]\n[s648-114,Grassley, Chuck,REFERRED,A bill to amend title XVIII of the Social Security Act to improve formulary requirements for prescription drug plans and MA-PD plans with respect to certain categories or classes of drugs.]\n[s1254-114,Grassley, Chuck,REFERRED,A bill to provide for the issuance and sale of a semipostal by the United States Postal Service to support effective programs targeted at improving permanency outcomes for youth in foster care.]\n[s626-114,Grassley, Chuck,REFERRED,A bill to amend title XIX of the Social Security Act to cover physician services delivered by podiatric physicians to ensure access by Medicaid beneficiaries to appropriate quality foot and ankle care, to amend title XVIII of such Act to modify the requirements for diabetic shoes to be included under Medicare, and for other purposes.]\n[s2043-114,Grassley, Chuck,REFERRED,A bill to revise counseling requirements for certain borrowers of student loans and for other purposes.]\n[s194-114,Grassley, Chuck,REFERRED,A bill to amend title 11 of the United States Code to clarify the rule allowing discharge as a nonpriority claim of governmental claims arising from the disposition of farm assets under chapter 12 bankruptcies.]\n[s607-114,Grassley, Chuck,REPORTED,A bill to amend title XVIII of the Social Security Act to provide for a five-year extension of the rural community hospital demonstration program, and for other purposes.]\n[s579-114,Grassley, Chuck,REPORTED,A bill to amend the Inspector General Act of 1978 to strengthen the independence of the Inspectors General, and for other purposes.]\n[s529-114,Grassley, Chuck,REFERRED,A bill to improve the services available to runaway and homeless youth who are victims of trafficking, to improve the response to victims of child sex trafficking, to direct the Interagency Task Force to Monitor and Combat Trafficking to identify strategies to prevent children from becoming victims of trafficking and review trafficking prevention efforts, to protect and assist in the recovery of victims of trafficking, and for other purposes.]\n[s1812-114,Grassley, Chuck,REFERRED,A bill to protect public safety by incentivizing State and local law enforcement to cooperate with Federal immigration law enforcement to prevent the release of criminal aliens into communities.]\n[s1169-114,Grassley, Chuck,REPORTED,A bill to reauthorize and improve the Juvenile Justice and Delinquency Prevention Act of 1974, and for other purposes.]\n[s1137-114,Grassley, Chuck,REPORTED,A bill to amend title 35, United States Code, and the Leahy-Smith America Invents Act to make improvements and technical corrections, and for other purposes.]\n[s1120-114,Grassley, Chuck,REFERRED,A bill to make aliens associated with a criminal gang inadmissible, deportable, and ineligible for various forms of relief.]\n[s401-114,Grassley, Chuck,REFERRED,A bill to amend rule 11 of the Federal Rules of Civil Procedure to improve attorney accountability, and for other purposes.]\n[s395-114,Grassley, Chuck,REFERRED,A bill to implement a demonstration project under titles XVIII and XIX of the Social Security Act to examine the costs and benefits of providing payments for comprehensive coordinated health care services provided by purpose-built, continuing care retirement communities to Medicare beneficiaries.]\n[s378-114,Grassley, Chuck,REFERRED,A bill to impose certain limitations on consent decrees and settlement agreements by agencies that require the agencies to take regulatory action in accordance with the terms thereof, and for other purposes.]\n[s363-114,Grassley, Chuck,REFERRED,A bill to amend the Elementary and Secondary Education Act of 1965 to aid gifted and talented and high-ability learners by empowering the Nation's teachers, and for other purposes.]\n[s1032-114,Grassley, Chuck,REFERRED,A bill to expand the use of E-Verify, to hold employers accountable, and for other purposes.]\n[s349-114,Grassley, Chuck,PASS_OVER:SENATE,A bill to amend title XIX of the Social Security Act to empower individuals with disabilities to establish their own supplemental needs trusts.]\n[s335-114,Grassley, Chuck,REPORTED,A bill to amend the Internal Revenue Code of 1986 to improve 529 plans.]\n[s332-114,Grassley, Chuck,REFERRED,A bill to amend title XVIII of the Social Security Act to make permanent the extension of the Medicare-dependent hospital (MDH) program and the increased payments under the Medicare low-volume hospital program.]\n[s314-114,Grassley, Chuck,REFERRED,A bill to amend title XVIII of the Social Security Act to provide for coverage under the Medicare program of pharmacist services.]\n[s1697-114,Grassley, Chuck,REFERRED,A bill to provide an exception from certain group health plan requirements to allow small businesses to use pre-tax dollars to assist employees in the purchase of policies in the individual health insurance market, and for other purposes.]\n[s313-114,Grassley, Chuck,REPORTED,A bill to amend title XVIII of the Social Security Act to add physical therapists to the list of providers allowed to utilize locum tenens arrangements under Medicare.]\n[s298-114,Grassley, Chuck,REFERRED,A bill to amend titles XIX and XXI of the Social Security Act to provide States with the option of providing services to children with medically complex conditions under the Medicaid program and Children's Health Insurance Program through a care coordination program focused on improving health outcomes for children with medically complex conditions and lowering costs, and for other purposes.]\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 48
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Grassley's Enacted Bills: **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "sqlContext.\n  sql(\"\"\"\n  |select\n  |  bill_id,\n  |  sponsor['name'],\n  |  status,\n  |  official_title\n  |from\n  |  all_bills\n  |where\n  |  sponsor['thomas_id'] = 457\n  |  and status like 'ENACTED%'\n  |\"\"\".stripMargin).\n  foreach(println)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "[s1482-114,Grassley, Chuck,ENACTED:SIGNED,A bill to improve and reauthorize provisions relating to the application of the antitrust laws to the award of need-based educational aid.]\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 49
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Benjamin Cardin's Sponsored Bills: **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "sqlContext.\n  sql(\"\"\"\n  |select\n  |  bill_id,\n  |  sponsor['name'],\n  |  status,\n  |  official_title\n  |from\n  |  all_bills\n  |where\n  |  sponsor['thomas_id'] = 174 \n  |\"\"\".stripMargin).\n  foreach(println)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "[s1652-114,Cardin, Benjamin L.,REFERRED,A bill to designate an existing Federal officer to coordinate efforts to secure the release of United States persons who are hostages of hostile groups or state sponsors of terrorism, and for other purposes.]\n[s2376-114,Cardin, Benjamin L.,REFERRED,A bill to require the Attorney General to make competitive grants to State, tribal, and local governments to establish and maintain witness protection and assistance programs.]\n[s2364-114,Cardin, Benjamin L.,REFERRED,A bill to permit occupational therapists to conduct the initial assessment visit under a Medicare home health plan of care for certain rehabilitation cases.]\n[s1610-114,Cardin, Benjamin L.,REFERRED,A bill to eliminate racial profiling by law enforcement officers, promote accountability for State and local law enforcement agencies, reenfranchise citizens, eliminate sentencing disparities, and promote re-entry and employment programs, and for other purposes.]\n[s1605-114,Cardin, Benjamin L.,REFERRED,A bill to amend the Millennium Challenge Act of 2003 to authorize concurrent compacts for purposes of regional economic integration and cross-border collaborations, and for other purposes.]\n[s2333-114,Cardin, Benjamin L.,REFERRED,A bill to amend the Internal Revenue Code of 1986 to provide taxpayer protection and assistance, and for other purposes.]\n[s2308-114,Cardin, Benjamin L.,PASS_OVER:SENATE,A bill to amend the Internal Revenue Code of 1986 to clarify the treatment of church pension plans, and for other purposes.]\n[s1554-114,Cardin, Benjamin L.,REFERRED,A bill to amend the Federal Water Pollution Control Act and to direct the Secretary of the Interior to conduct a study with respect to stormwater runoff from oil and gas operations, and for other purposes.]\n[s772-114,Cardin, Benjamin L.,REFERRED,A bill to secure the Federal voting rights of persons when released from incarceration.]\n[s756-114,Cardin, Benjamin L.,PASS_OVER:SENATE,A bill to require a report on accountability for war crimes and crimes against humanity in Syria.]\n[s2168-114,Cardin, Benjamin L.,REFERRED,A bill to encourage greater community accountability of law enforcement agencies, and for other purposes.]\n[s741-114,Cardin, Benjamin L.,REFERRED,A bill to authorize the Administrator of the Environmental Protection Agency to establish a program of awarding grants to owners or operators of water systems to increase the resiliency or adaptability of the systems to any ongoing or forecasted changes to the hydrologic conditions of a region of the United States.]\n[s2119-114,Cardin, Benjamin L.,REFERRED,A bill to provide for greater congressional oversight of Iran's nuclear program, and for other purposes.]\n[s1349-114,Cardin, Benjamin L.,REPORTED,A bill to amend title XVIII of the Social Security Act to require hospitals to provide certain notifications to individuals classified by such hospitals under observation status rather than admitted as inpatients of such hospitals.]\n[s665-114,Cardin, Benjamin L.,ENACTED:SIGNED,A bill to encourage, enhance, and integrate Blue Alert plans throughout the United States in order to disseminate information when a law enforcement officer is seriously injured or killed in the line of duty, is missing in connection with the officer's official duties, or an imminent and credible threat that an individual intends to cause the serious injury or death of a law enforcement officer is received, and for other purposes.]\n[s653-114,Cardin, Benjamin L.,PASS_OVER:SENATE,A bill to amend the Water Resources Research Act of 1984 to reauthorize grants for and require applied water supply research regarding the water resources research and technology institutes established under that Act.]\n[s619-114,Cardin, Benjamin L.,REFERRED,A bill to include among the principal trade negotiating objectives of the United States regarding commercial partnerships trade negotiating objectives with respect to discouraging activity that discourages, penalizes, or otherwise limits commercial relations with Israel, and for other purposes.]\n[s2035-114,Cardin, Benjamin L.,REPORTED,A bill to provide for the compensation of Federal employees affected by a lapse in appropriations.]\n[s610-114,Cardin, Benjamin L.,REPORTED,A bill to authorize the Secretary of the Interior to conduct a special resource study of P.S. 103 in West Baltimore, Maryland and for other purposes.]\n[s599-114,Cardin, Benjamin L.,ENACTED:SIGNED,A bill to extend and expand the Medicaid emergency psychiatric demonstration project.]\n[s598-114,Cardin, Benjamin L.,REFERRED,A bill to improve the understanding of, and promote access to treatment for, chronic kidney disease, and for other purposes.]\n[s1982-114,Cardin, Benjamin L.,REFERRED,A bill to authorize a Wall of Remembrance as part of the Korean War Veterans Memorial and to allow certain private contributions to fund the Wall of Remembrance.]\n[s554-114,Cardin, Benjamin L.,REFERRED,A bill to provide for the compensation of Federal employees affected by a lapse in appropriations.]\n[s1212-114,Cardin, Benjamin L.,REFERRED,A bill to amend the Internal Revenue Code of 1986 and the Small Business Act to expand the availability of employee stock ownership plans in S corporations, and for other purposes.]\n[s539-114,Cardin, Benjamin L.,REFERRED,A bill to amend title XVIII of the Social Security Act to repeal the Medicare outpatient rehabilitation therapy caps.]\n[s1882-114,Cardin, Benjamin L.,REFERRED,A bill to support the sustainable recovery and rebuilding of Nepal following the recent, devastating earthquakes near Kathmandu.]\n[s526-114,Cardin, Benjamin L.,REFERRED,A bill to sunset the 2001 Authorization for Use of Military Force after three years.]\n[s521-114,Cardin, Benjamin L.,REPORTED,A bill to authorize the Secretary of the Interior to conduct a special resource study of President Station in Baltimore, Maryland, and for other purposes.]\n[s520-114,Cardin, Benjamin L.,REFERRED,A bill to amend the Neotropical Migratory Bird Conservation Act to reauthorize the Act.]\n[s519-114,Cardin, Benjamin L.,REFERRED,A bill to amend the Chesapeake Bay Initiative Act of 1998 to permanently reauthorize the Chesapeake Bay Gateways and Watertrails Network.]\n[s518-114,Cardin, Benjamin L.,REFERRED,A bill to require States to establish highway stormwater management programs.]\n[s1079-114,Cardin, Benjamin L.,REFERRED,A bill to amend titles XI and XVIII of the Social Security Act and title XXVII of the Public Health Service Act to improve coverage for colorectal screening tests under Medicare and private health insurance coverage, and for other purposes.]\n[s375-114,Cardin, Benjamin L.,REFERRED,A bill to amend the Internal Revenue Code of 1986 to provide a reduced rate of excise tax on beer produced domestically by certain qualifying producers.]\n[s1056-114,Cardin, Benjamin L.,REFERRED,A bill to eliminate racial profiling by law enforcement, and for other purposes.]\n[s1746-114,Cardin, Benjamin L.,REFERRED,A bill to require the Office of Personnel Management to provide complimentary, comprehensive identity protection coverage to all individuals whose personally identifiable information was compromised during recent data breaches at Federal agencies.]\n[s1002-114,Cardin, Benjamin L.,REFERRED,A bill to amend the Internal Revenue Code of 1986 to provide for collegiate housing and infrastructure grants.]\n[s284-114,Cardin, Benjamin L.,PASS_OVER:SENATE,A bill to impose sanctions with respect to foreign persons responsible for gross violations of internationally recognized human rights, and for other purposes.]\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 52
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Benjamin Cardin's Enacted Bills: **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "sqlContext.\n  sql(\"\"\"\n  |select\n  |  bill_id,\n  |  sponsor['name'],\n  |  status,\n  |  official_title\n  |from\n  |  all_bills\n  |where\n  |  sponsor['thomas_id'] = 174 \n  |  and status like 'ENACTED%'\n  |\"\"\".stripMargin).\n  foreach(println)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "[s665-114,Cardin, Benjamin L.,ENACTED:SIGNED,A bill to encourage, enhance, and integrate Blue Alert plans throughout the United States in order to disseminate information when a law enforcement officer is seriously injured or killed in the line of duty, is missing in connection with the officer's official duties, or an imminent and credible threat that an individual intends to cause the serious injury or death of a law enforcement officer is received, and for other purposes.]\n[s599-114,Cardin, Benjamin L.,ENACTED:SIGNED,A bill to extend and expand the Medicaid emergency psychiatric demonstration project.]\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 53
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Now the House or Reps ... **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "val representatives = legislators.filter(_.isRep)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "representatives: org.apache.spark.rdd.RDD[Legislator] = MapPartitionsRDD[928] at filter at <console>:63\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "MapPartitionsRDD[928] at filter at &lt;console&gt;:63"
      },
      "output_type" : "execute_result",
      "execution_count" : 50
    } ]
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "representatives.count",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "res35: Long = 440\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "440"
      },
      "output_type" : "execute_result",
      "execution_count" : 51
    } ]
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "representatives.groupBy(_.party).map{ case (party, lst) => (party, lst.size) }.collect()",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "res36: Array[(String, Int)] = Array((Independent,1), (Republican,247), (Democrat,192))\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "<div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon25a15164efcefb362a5ef78b09195400&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;Independent&quot;,&quot;_2&quot;:1},{&quot;_1&quot;:&quot;Republican&quot;,&quot;_2&quot;:247},{&quot;_1&quot;:&quot;Democrat&quot;,&quot;_2&quot;:192}],&quot;genId&quot;:&quot;1359286593&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tabs'], \n      function(playground, _magictabs) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictabs,\n    \"o\": {}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon1702408064bb3a6e8f63d1b3f34c6d9d\">\n      Max Points (controlling all tabs)\n    </label><input id=\"input-anon1702408064bb3a6e8f63d1b3f34c6d9d\" type=\"number\" name=\"input-anon1702408064bb3a6e8f63d1b3f34c6d9d\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon1702408064bb3a6e8f63d1b3f34c6d9d\" data-this=\"{&quot;valueId&quot;:&quot;anon1702408064bb3a6e8f63d1b3f34c6d9d&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <div>\n          <ul class=\"nav nav-tabs\" id=\"ul1359286593\"><li>\n                <a href=\"#tab1359286593-0\"><i class=\"fa fa-table\"/></a>\n              </li><li>\n                <a href=\"#tab1359286593-1\"><i class=\"fa fa-bar-chart\"/></a>\n              </li><li>\n                <a href=\"#tab1359286593-2\"><i class=\"fa fa-pie-chart\"/></a>\n              </li></ul>\n\n          <div class=\"tab-content\" id=\"tab1359286593\"><div class=\"tab-pane\" id=\"tab1359286593-0\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon06ae820c44a15091423f8c285c9744b2&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;Independent&quot;,&quot;_2&quot;:1},{&quot;_1&quot;:&quot;Republican&quot;,&quot;_2&quot;:247},{&quot;_1&quot;:&quot;Democrat&quot;,&quot;_2&quot;:192}],&quot;genId&quot;:&quot;1384972364&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tableChart'], \n      function(playground, _magictableChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictableChart,\n    \"o\": {\"headers\":[\"_1\",\"_2\"],\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon4be20af73954c81e3b49105adabae053\">\n      Max Points\n    </label><input id=\"input-anon4be20af73954c81e3b49105adabae053\" type=\"number\" name=\"input-anon4be20af73954c81e3b49105adabae053\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon4be20af73954c81e3b49105adabae053\" data-this=\"{&quot;valueId&quot;:&quot;anon4be20af73954c81e3b49105adabae053&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon0a97db531a17606be249f11a0462c921&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon5064b00776ff471281e5b8a467811025&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab1359286593-1\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon3354901f4c9b7a5b21b44a58d6fbd260&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;Independent&quot;,&quot;_2&quot;:1},{&quot;_1&quot;:&quot;Republican&quot;,&quot;_2&quot;:247},{&quot;_1&quot;:&quot;Democrat&quot;,&quot;_2&quot;:192}],&quot;genId&quot;:&quot;266138082&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/barChart'], \n      function(playground, _magicbarChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicbarChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon655ee6d425ccf461b1f778467d40aadb\">\n      Max Points\n    </label><input id=\"input-anon655ee6d425ccf461b1f778467d40aadb\" type=\"number\" name=\"input-anon655ee6d425ccf461b1f778467d40aadb\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon655ee6d425ccf461b1f778467d40aadb\" data-this=\"{&quot;valueId&quot;:&quot;anon655ee6d425ccf461b1f778467d40aadb&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon1fc16201f727a4a95aa9bc1f888d4b6a&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon6ac4c4800fa77fd40614c50439c91d8c&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab1359286593-2\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon79ce2d92a442ed2acca8a6ae62e80330&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;Independent&quot;,&quot;_2&quot;:1},{&quot;_1&quot;:&quot;Republican&quot;,&quot;_2&quot;:247},{&quot;_1&quot;:&quot;Democrat&quot;,&quot;_2&quot;:192}],&quot;genId&quot;:&quot;1625162457&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/pieChart'], \n      function(playground, _magicpieChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicpieChart,\n    \"o\": {\"series\":\"_1\",\"p\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon70a97ebd10463fbbd9155c6863f2023b\">\n      Max Points\n    </label><input id=\"input-anon70a97ebd10463fbbd9155c6863f2023b\" type=\"number\" name=\"input-anon70a97ebd10463fbbd9155c6863f2023b\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon70a97ebd10463fbbd9155c6863f2023b\" data-this=\"{&quot;valueId&quot;:&quot;anon70a97ebd10463fbbd9155c6863f2023b&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anona66aa6f8cbd7d818714b0efe7b97340a&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon4fc2e81d924690c8f45b3cff7703b45f&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div></div>\n        </div>\n      </div></div>"
      },
      "output_type" : "execute_result",
      "execution_count" : 52
    } ]
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "representatives.groupBy(_.gender).map{ case (gender, lst) => (gender, lst.size) }.collect()",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "res37: Array[(String, Int)] = Array((F,88), (M,352))\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "<div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon4f91cfd4049931b1cbeeef46033cb130&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;F&quot;,&quot;_2&quot;:88},{&quot;_1&quot;:&quot;M&quot;,&quot;_2&quot;:352}],&quot;genId&quot;:&quot;227313601&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tabs'], \n      function(playground, _magictabs) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictabs,\n    \"o\": {}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anonceec42873047d74f6328c7a9a4cc8070\">\n      Max Points (controlling all tabs)\n    </label><input id=\"input-anonceec42873047d74f6328c7a9a4cc8070\" type=\"number\" name=\"input-anonceec42873047d74f6328c7a9a4cc8070\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anonceec42873047d74f6328c7a9a4cc8070\" data-this=\"{&quot;valueId&quot;:&quot;anonceec42873047d74f6328c7a9a4cc8070&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <div>\n          <ul class=\"nav nav-tabs\" id=\"ul227313601\"><li>\n                <a href=\"#tab227313601-0\"><i class=\"fa fa-table\"/></a>\n              </li><li>\n                <a href=\"#tab227313601-1\"><i class=\"fa fa-bar-chart\"/></a>\n              </li><li>\n                <a href=\"#tab227313601-2\"><i class=\"fa fa-pie-chart\"/></a>\n              </li></ul>\n\n          <div class=\"tab-content\" id=\"tab227313601\"><div class=\"tab-pane\" id=\"tab227313601-0\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon8913f2fbd3f73b15731b3f12ce058185&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;F&quot;,&quot;_2&quot;:88},{&quot;_1&quot;:&quot;M&quot;,&quot;_2&quot;:352}],&quot;genId&quot;:&quot;1522482983&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tableChart'], \n      function(playground, _magictableChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictableChart,\n    \"o\": {\"headers\":[\"_1\",\"_2\"],\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anond0dcef5421002c84f95a4df7d7291650\">\n      Max Points\n    </label><input id=\"input-anond0dcef5421002c84f95a4df7d7291650\" type=\"number\" name=\"input-anond0dcef5421002c84f95a4df7d7291650\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anond0dcef5421002c84f95a4df7d7291650\" data-this=\"{&quot;valueId&quot;:&quot;anond0dcef5421002c84f95a4df7d7291650&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anone0478ad4ab8ec57b5f12765722bafc17&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon17002d83112267aaaddf43a7b4348e49&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab227313601-1\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon508c12da2ec171d467c81f2349c0a94b&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;F&quot;,&quot;_2&quot;:88},{&quot;_1&quot;:&quot;M&quot;,&quot;_2&quot;:352}],&quot;genId&quot;:&quot;1996057041&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/barChart'], \n      function(playground, _magicbarChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicbarChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anoncbc8b523a4b5e8f939214c96c6a61447\">\n      Max Points\n    </label><input id=\"input-anoncbc8b523a4b5e8f939214c96c6a61447\" type=\"number\" name=\"input-anoncbc8b523a4b5e8f939214c96c6a61447\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anoncbc8b523a4b5e8f939214c96c6a61447\" data-this=\"{&quot;valueId&quot;:&quot;anoncbc8b523a4b5e8f939214c96c6a61447&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon033cd58b53c972e0e4828ebc70ccc8f0&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon16f0bbbadb2ed807b971d482ea622328&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab227313601-2\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anonceabce881c7c6eb61a8493325a8b3719&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;F&quot;,&quot;_2&quot;:88},{&quot;_1&quot;:&quot;M&quot;,&quot;_2&quot;:352}],&quot;genId&quot;:&quot;152479862&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/pieChart'], \n      function(playground, _magicpieChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicpieChart,\n    \"o\": {\"series\":\"_1\",\"p\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon00cf0099f857049b612a758cf899a039\">\n      Max Points\n    </label><input id=\"input-anon00cf0099f857049b612a758cf899a039\" type=\"number\" name=\"input-anon00cf0099f857049b612a758cf899a039\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon00cf0099f857049b612a758cf899a039\" data-this=\"{&quot;valueId&quot;:&quot;anon00cf0099f857049b612a758cf899a039&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anond04456bb80c4cdba76468968af40175e&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon85da61a5985d076d7589a2e2b02ee389&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div></div>\n        </div>\n      </div></div>"
      },
      "output_type" : "execute_result",
      "execution_count" : 53
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Convert the Senate Bills into Edges (cosponsor -> sponsor) **\n\nEach Edge is directional from a bill's cosponsor to the bill's sponsor."
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "val houseBills = bills.filter(_.isHouseBill)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "houseBills: org.apache.spark.rdd.RDD[Bill] = MapPartitionsRDD[935] at filter at <console>:62\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "MapPartitionsRDD[935] at filter at &lt;console&gt;:62"
      },
      "output_type" : "execute_result",
      "execution_count" : 54
    } ]
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "houseBills.count",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "res38: Long = 4382\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "4382"
      },
      "output_type" : "execute_result",
      "execution_count" : 55
    } ]
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "val houseEdges =\n  houseBills.flatMap(bill => bill.cosponsorThomasIds.map(cosponsorId => Edge(cosponsorId, bill.sponsorThomasId, None)))",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "houseEdges: org.apache.spark.rdd.RDD[org.apache.spark.graphx.Edge[None.type]] = MapPartitionsRDD[936] at flatMap at <console>:64\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "MapPartitionsRDD[936] at flatMap at &lt;console&gt;:64"
      },
      "output_type" : "execute_result",
      "execution_count" : 56
    } ]
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "houseEdges.count",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "res39: Long = 72487\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "72487"
      },
      "output_type" : "execute_result",
      "execution_count" : 57
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Convert the Representatives into Graph Vertices **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "val houseVertices = representatives.keyBy(_.thomasId)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "houseVertices: org.apache.spark.rdd.RDD[(Long, Legislator)] = MapPartitionsRDD[937] at keyBy at <console>:64\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "MapPartitionsRDD[937] at keyBy at &lt;console&gt;:64"
      },
      "output_type" : "execute_result",
      "execution_count" : 58
    } ]
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "houseVertices.count",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "res40: Long = 440\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "440"
      },
      "output_type" : "execute_result",
      "execution_count" : 59
    } ]
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "houseVertices.take(5).foreach(println)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "(1460,Aderholt, Robert, Republican, rep, AL, M, 1965-07-22, 1460)\n(2029,Amash, Justin, Republican, rep, MI, M, 1980-04-18, 2029)\n(2054,Barletta, Lou, Republican, rep, PA, M, 1956-01-28, 2054)\n(62,Barton, Joe, Republican, rep, TX, M, 1949-09-15, 62)\n(1996,Bass, Karen, Democrat, rep, CA, F, 1953-10-03, 1996)\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 60
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Create the House of Representatives Influence Graph **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "val houseGraph = Graph(houseVertices, houseEdges)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "houseGraph: org.apache.spark.graphx.Graph[Legislator,None.type] = org.apache.spark.graphx.impl.GraphImpl@622f73a\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "org.apache.spark.graphx.impl.GraphImpl@622f73a"
      },
      "output_type" : "execute_result",
      "execution_count" : 61
    } ]
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "houseGraph.numEdges",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "res42: Long = 72487\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "72487"
      },
      "output_type" : "execute_result",
      "execution_count" : 62
    } ]
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "houseGraph.numVertices",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "res43: Long = 443\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "443"
      },
      "output_type" : "execute_result",
      "execution_count" : 63
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Run a House Influence PageRank: **\n\nSee: https://spark.apache.org/docs/1.5.2/graphx-programming-guide.html#pagerank"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "val housePageRank = houseGraph.ops.pageRank(0.0001)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "housePageRank: org.apache.spark.graphx.Graph[Double,Double] = org.apache.spark.graphx.impl.GraphImpl@73d21a35\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "org.apache.spark.graphx.impl.GraphImpl@73d21a35"
      },
      "output_type" : "execute_result",
      "execution_count" : 64
    } ]
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "housePageRank.vertices.take(5).foreach(println)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "(2002,0.17082197402877078)\n(2242,0.4856760257806809)\n(2054,1.1690770397188366)\n(1868,0.20837674289327385)\n(930,0.2591356484997774)\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 65
    } ]
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "housePageRank.vertices.join(houseVertices).sortBy(_._2._1, ascending = false).take(10).foreach(println)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "(2063,(7.3113154917839145,Black, Diane, Republican, rep, TN, F, 1951-01-16, 2063))\n(1922,(5.710721103233108,Guthrie, Brett, Republican, rep, KY, M, 1964-02-18, 1922))\n(603,(5.662304366001904,Johnson, Sam, Republican, rep, TX, M, 1930-10-11, 603))\n(1930,(5.508399819995292,Paulsen, Erik, Republican, rep, MN, M, 1965-05-14, 1930))\n(1787,(5.072929713510114,Boustany, Charles, Republican, rep, LA, M, 1956-02-21, 1787))\n(1071,(4.473491854920167,Smith, Christopher, Republican, rep, NJ, M, 1953-03-04, 1071))\n(1992,(4.321637548143592,Gosar, Paul, Republican, rep, AZ, M, 1958-11-22, 1992))\n(729,(4.27194094084253,Maloney, Carolyn, Democrat, rep, NY, F, 1946-02-19, 729))\n(1468,(4.169420724184261,Brady, Kevin, Republican, rep, TX, M, 1955-04-11, 1468))\n(1982,(3.9814649210007675,Reed, Tom, Republican, rep, NY, M, 1971-11-18, 1982))\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 66
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Diane Black's Sponsored Bills: **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "sqlContext.\n  sql(\"\"\"\n  |select\n  |  bill_id,\n  |  sponsor['name'],\n  |  status,\n  |  official_title\n  |from\n  |  all_bills\n  |where\n  |  sponsor['thomas_id'] = 2063 \n  |\"\"\".stripMargin).\n  foreach(println)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "[hr887-114,Black, Diane,REPORTED,To amend title XVIII of the Social Security Act with respect to the treatment of patient encounters in ambulatory surgical centers in determining meaningful EHR use, and for other purposes.]\n[hr4059-114,Black, Diane,REFERRED,To amend title XVIII of the Social Security Act to encourage Medicare beneficiaries to voluntarily adopt advance directives guiding the medical care they receive.]\n[hr3296-114,Black, Diane,REFERRED,To clarify that the oath of allegiance to the United States administered in the naturalization process may not be altered.]\n[hr866-114,Black, Diane,REFERRED,To achieve domestic energy independence by empowering States to control the development and production of all forms of energy on all available Federal land.]\n[hr2502-114,Black, Diane,REFERRED,To amend title XVIII of the Social Security Act to provide for bundled payments for certain episodes of care surrounding a hospitalization.]\n[hr1739-114,Black, Diane,REFERRED,To prohibit the Federal Government from requiring race or ethnicity to be disclosed in connection with the transfer of a firearm.]\n[hr4026-114,Black, Diane,REFERRED,To provide that a concealed handgun license shall be treated as a verifying identity document for purposes of aircraft passenger security screening, and to prohibit the Federal Government from collecting or storing information about an individual relating to a concealed handgun license.]\n[hr2434-114,Black, Diane,REFERRED,To amend the Internal Revenue Code of 1986 to provide for a refundable adoption tax credit.]\n[hr3197-114,Black, Diane,REFERRED,To prohibit Federal funding to entities that do not certify the entities will not perform, or provide any funding to any other entity that performs, an abortion.]\n[hr3135-114,Black, Diane,REFERRED,To amend section 413 of the Energy Independence and Security Act of 2007 with respect to energy efficiency standards for manufactured housing.]\n[hr3134-114,Black, Diane,PASS_OVER:HOUSE,To provide for a moratorium on Federal funding to Planned Parenthood Federation of America, Inc.]\n[hr3803-114,Black, Diane,REFERRED,To amend the Congressional Budget Act of 1974 to establish joint resolutions on the budget, and for other purposes.]\n[hr3052-114,Black, Diane,REFERRED,To amend title 28, United States Code, to prevent the misuse of foreign law in Federal courts, and for other purposes.]\n[hr2247-114,Black, Diane,REFERRED,To require the Secretary of Health and Human Services to provide for transparent testing to assess the transition under the Medicare fee-for-service claims processing system from the ICD-9 to the ICD-10 standard, and for other purposes.]\n[hr3701-114,Black, Diane,REFERRED,To require that the Secretary of the Treasury make available an Internet platform for Form 1099 filings.]\n[hr2973-114,Black, Diane,REFERRED,To amend the Internal Revenue Code of 1986 to require for purposes of education tax credit that the student be lawfully present and that the taxpayer provide the social security number of the student and the employer identification number of the educational institution, and for other purposes.]\n[hr217-114,Black, Diane,REFERRED,To amend title X of the Public Health Service Act to prohibit family planning grants from being awarded to any entity that performs abortions, and for other purposes.]\n[hr555-114,Black, Diane,REFERRED,To require an Exchange established under the Patient Protection and Affordable Care Act to notify individuals in the case that personal information of such individuals is known to have been acquired or accessed as a result of a breach of the security of any system maintained by the Exchange, and for other purposes.]\n[hr276-114,Black, Diane,REFERRED,To prohibit the Secretary of Homeland Security from using Federal funds for the position of Public Advocate, or the position of Deputy Assistant Director of Custody Programs and Community Outreach, within U.S. Immigration and Customs Enforcement, and for other purposes.]\n[hr2712-114,Black, Diane,REFERRED,To streamline the employer reporting process and strengthen the eligibility verification process for the health care premium tax credit and cost-sharing subsidy, and for other purposes.]\n[hr2711-114,Black, Diane,REFERRED,To delay the provision of the Affordable Care Act premium and cost-sharing subsidies until the eligibility verification process for such subsidies is completed, and for other purposes.]\n[hr940-114,Black, Diane,REFERRED,To amend the Patient Protection and Affordable Care Act to protect rights of conscience with regard to requirements for coverage of specific items and services, to amend the Public Health Service Act to prohibit certain abortion-related discrimination in governmental activities, and for other purposes.]\n[hr4155-114,Black, Diane,REFERRED,To require the Center for Medicare and Medicaid Innovation to test the effect of including telehealth services in Medicare health care delivery reform models.]\n[hr2579-114,Black, Diane,REPORTED,To amend title XVIII of the Social Security Act to improve the risk adjustment under the Medicare Advantage program, and for other purposes.]\n[hr4141-114,Black, Diane,REFERRED,To ensure that tax return preparers demonstrate minimum standards of competency.]\n[hr2570-114,Black, Diane,PASS_OVER:HOUSE,To amend title XVIII of the Social Security Act with respect to the treatment of patient encounters in ambulatory surgical centers in determining meaningful EHR use, establish a demonstration program requiring the utilization of Value-Based Insurance Design to demonstrate that reducing the copayments or coinsurance charged to Medicare beneficiaries for selected high-value prescription medications and clinical services can increase their utilization and ultimately improve clinical outcomes and lower health care expenditures, and for other purposes.]\n[hr1063-114,Black, Diane,REFERRED,To amend the Harmonized Tariff Schedule of the United States to eliminate tariffs on technological goods providing educational value for children, and for other purposes.]\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 67
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Diane Black's Enacted Bills: **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "sqlContext.\n  sql(\"\"\"\n  |select\n  |  bill_id,\n  |  sponsor['name'],\n  |  status,\n  |  official_title\n  |from\n  |  all_bills\n  |where\n  |  sponsor['thomas_id'] = 2063 \n  |  and status like 'ENACTED%'\n  |\"\"\".stripMargin).\n  foreach(println)",
    "outputs" : [ {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 68
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Brett Guthrie's Sponsored Bills: **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "sqlContext.\n  sql(\"\"\"\n  |select\n  |  bill_id,\n  |  sponsor['name'],\n  |  status,\n  |  official_title\n  |from\n  |  all_bills\n  |where\n  |  sponsor['thomas_id'] = 1922\n  |\"\"\".stripMargin).\n  foreach(println)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "[hr2446-114,Guthrie, Brett,REFERRED,To amend title XIX of the Social Security Act to require the use of electronic visit verification for personal care services furnished under the Medicaid program, and for other purposes.]\n[hr2445-114,Guthrie, Brett,REFERRED,To express the sense of Congress with respect to enabling Food and Drug Administration scientific engagement.]\n[hr2444-114,Guthrie, Brett,REFERRED,To authorize the Commissioner of Food and Drugs to award grants for studying the process of continuous drug manufacturing.]\n[hr2443-114,Guthrie, Brett,REFERRED,To amend the Federal Food, Drug, and Cosmetic Act with respect to CLIA waiver study design guidance for in vitro diagnostics.]\n[hr1641-114,Guthrie, Brett,REFERRED,To amend the National Telecommunications and Information Administration Organization Act to provide incentives for the reallocation of Federal Government spectrum for commercial use, and for other purposes.]\n[hr3179-114,Guthrie, Brett,REFERRED,To amend the loan counseling requirements under the Higher Education Act of 1965, and for other purposes.]\n[hr1624-114,Guthrie, Brett,ENACTED:SIGNED,To amend title I of the Patient Protection and Affordable Care Act and title XXVII of the Public Health Service Act to revise the definition of small employer.]\n[hr3682-114,Guthrie, Brett,REFERRED,To increase the competitiveness of American manufacturing by reducing regulatory and other burdens, encouraging greater innovation and investment, and developing a stronger workforce for the twenty-first century, and for other purposes.]\n[hr592-114,Guthrie, Brett,REFERRED,To amend title XVIII of the Social Security Act to provide for coverage under the Medicare program of pharmacist services.]\n[hr1362-114,Guthrie, Brett,REFERRED,To amend title XIX of the Social Security Act to require States to submit an annual report on sources of funds used to finance the non-Federal share of expenditures under such title, and for other purposes.]\n[hr1361-114,Guthrie, Brett,REFERRED,To amend title XIX of the Social Security Act to eliminate the State option to reduce the home equity exemption amount for purposes of eligibility for long-term care assistance under Medicaid, and for other purposes.]\n[hr2107-114,Guthrie, Brett,REFERRED,To amend title XIX of the Social Security Act to clarify the treatment of certain Medicaid enrollment brokers.]\n[hr1344-114,Guthrie, Brett,PASS_OVER:HOUSE,To amend the Public Health Service Act to reauthorize a program for early detection, diagnosis, and treatment regarding deaf and hard-of-hearing newborns, infants, and young children.]\n[hr985-114,Guthrie, Brett,REPORTED,To enable concrete masonry products manufacturers to establish, finance, and carry out a coordinated program of research, education, and promotion to improve, maintain, and develop markets for concrete masonry products.]\n[hr921-114,Guthrie, Brett,REFERRED,To provide protections for certain sports medicine professionals who provide certain medical services in a secondary State.]\n[hr1101-114,Guthrie, Brett,REFERRED,To amend the Public Health Service Act to revise and extend the program for viral hepatitis surveillance, education, and testing in order to prevent deaths from chronic liver disease and liver cancer, and for other purposes.]\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 69
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Brett Guthrie's Enacted Bills: **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "sqlContext.\n  sql(\"\"\"\n  |select\n  |  bill_id,\n  |  sponsor['name'],\n  |  status,\n  |  official_title\n  |from\n  |  all_bills\n  |where\n  |  sponsor['thomas_id'] = 1922 \n  |  and status like 'ENACTED%'\n  |\"\"\".stripMargin).\n  foreach(println)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "[hr1624-114,Guthrie, Brett,ENACTED:SIGNED,To amend title I of the Patient Protection and Affordable Care Act and title XXVII of the Public Health Service Act to revise the definition of small employer.]\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 70
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Who has written the most bills that have passed both houses of congress? **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "sqlContext.\n  sql(\"\"\"\n  |select\n  |  sponsor['name'],\n  |  count(*) as count\n  |from\n  |  all_bills\n  |where\n  |  status like 'ENACTED%'\n  |group by sponsor['name']\n  |\"\"\".\n  stripMargin).\n  orderBy(\"count\").\n  foreach(println)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "[Wyden, Ron,3]\n[Shuster, Bill,5]\n[Wagner, Ann,3]\n[Alexander, Lamar,2]\n[Neugebauer, Randy,2]\n[Portman, Rob,2]\n[Katko, John,2]\n[Feinstein, Dianne,2]\n[Udall, Tom,2]\n[Hurd, Will,2]\n[Smith, Lamar,2]\n[Barletta, Lou,2]\n[Thune, John,2]\n[Cardin, Benjamin L.,2]\n[Booker, Cory A.,2]\n[Vitter, David,2]\n[Chabot, Steve,2]\n[Carper, Thomas R.,2]\n[Fortenberry, Jeff,1]\n[Payne, Donald M., Jr.,1]\n[Miller, Candice S.,1]\n[Grijalva, Raul M.,1]\n[Inhofe, James M.,1]\n[Klobuchar, Amy,1]\n[Lieu, Ted,1]\n[Cicilline, David N.,1]\n[Burgess, Michael C.,1]\n[Pitts, Joseph R.,1]\n[Meehan, Patrick,1]\n[Paulsen, Erik,1]\n[Ross, Dennis A.,1]\n[Pallone, Frank, Jr.,1]\n[Cuellar, Henry,1]\n[McConnell, Mitch,1]\n[McSally, Martha,1]\n[Serrano, Jose E.,1]\n[Walz, Timothy J.,1]\n[Jeffries, Hakeem S.,1]\n[Bordallo, Madeleine Z.,1]\n[Doggett, Lloyd,1]\n[Luetkemeyer, Blaine,1]\n[Sensenbrenner, F. James, Jr.,1]\n[Velazquez, Nydia M.,1]\n[Mullin, Markwayne,1]\n[Graves, Tom,1]\n[Royce, Edward R.,1]\n[McCarthy, Kevin,1]\n[Conaway, K. Michael,1]\n[Grassley, Chuck,1]\n[Heck, Denny,1]\n[Dent, Charles W.,1]\n[Bishop, Mike,1]\n[Rubio, Marco,1]\n[Lynch, Stephen F.,1]\n[Reichert, David G.,1]\n[Guthrie, Brett,1]\n[Coffman, Mike,1]\n[Buchanan, Vern,1]\n[Cohen, Steve,1]\n[Radewagen, Aumua Amata Coleman,1]\n[Brat, Dave,1]\n[Connolly, Gerald E.,1]\n[Rogers, Harold,1]\n[Brady, Kevin,1]\n[Latta, Robert E.,1]\n[Fischer, Deb,1]\n[Isakson, Johnny,1]\n[Wicker, Roger F.,1]\n[Gibson, Christopher P.,1]\n[Murkowski, Lisa,1]\n[Sewell, Terri A.,1]\n[Scott, David,1]\n[Holding, George,1]\n[Russell, Steve,1]\n[Smith, Christopher H.,1]\n[Davis, Rodney,1]\n[Corker, Bob,1]\n[Boozman, John,1]\n[Doyle, Michael F.,1]\n[Clyburn, James E.,1]\n[Johnson, Ron,1]\n[Blunt, Roy,1]\n[Cornyn, John,1]\n[Peters, Gary C.,1]\n[Simpson, Michael K.,1]\n[Wilson, Frederica S.,1]\n[Slaughter, Louise McIntosh,1]\n[Gardner, Cory,1]\n[Brooks, Susan W.,1]\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 53
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** What happens if we group all of the same edges between two nodes? **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "val senateGroupedEdgesGraph = senateGraph.groupEdges {\n  case (edge1, _) => edge1\n}",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "senateGroupedEdgesGraph: org.apache.spark.graphx.Graph[Legislator,None.type] = org.apache.spark.graphx.impl.GraphImpl@ba1b66c\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "org.apache.spark.graphx.impl.GraphImpl@ba1b66c"
      },
      "output_type" : "execute_result",
      "execution_count" : 54
    } ]
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "senateGroupedEdgesGraph.edges.take(5).foreach(println)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "Edge(116,136,None)\nEdge(116,172,None)\nEdge(116,174,None)\nEdge(116,250,None)\nEdge(116,326,None)\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 55
    } ]
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "import notebook.front.widgets.magic.{Node => MNode}\nimport notebook.front.widgets.magic.{Edge => MEdge}",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "import notebook.front.widgets.magic.{Node=>MNode}\nimport notebook.front.widgets.magic.{Edge=>MEdge}\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 56
    } ]
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "val mEdges = senateGroupedEdgesGraph.\n  edges.\n  zipWithIndex.\n  map { case (edge, index) => MEdge(index, (edge.srcId, edge.dstId), \"edge\") }.collect()\nval mNodes = senators.\n  filter(senator => \n  map(p => MNode(p.thomasId, p.name, color=p.party match { case \"Republican\" => \"red\"; case \"Democrat\" => \"blue\"; case _ => \"grey\" }))\nval mGraph = widgets.GraphChart(\n  mNodes ++ mEdges, \n  linkDistance = 100,\n  linkStrength = 0.5,\n  charge = -30,\n  // sizes = (800, 500),\n  maxPoints = 1000\n)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "<console>:8: error: ')' expected but 'val' found.\nval mGraph = widgets.GraphChart(\n^\n"
    } ]
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "val senateGroupedEdgesPageRank = senateGroupedEdgesGraph.ops.pageRank(0.0001)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "senateGroupedEdgesPageRank: org.apache.spark.graphx.Graph[Double,Double] = org.apache.spark.graphx.impl.GraphImpl@5e814f58\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "org.apache.spark.graphx.impl.GraphImpl@5e814f58"
      },
      "output_type" : "execute_result",
      "execution_count" : 58
    } ]
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "senateGroupedEdgesPageRank.\n  vertices.\n  join(senateVertices).\n  sortBy(_._2._1, ascending = false).\n  take(10).\n  foreach(println)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "(1351,(2.1343658450526024,Hatch, Orrin, Republican, sen, UT, M, 1934-03-22, 1351))\n(457,(2.0997837132389843,Grassley, Charles, Republican, sen, IA, M, 1933-09-17, 457))\n(1464,(2.0184207617366408,Blunt, Roy, Republican, sen, MO, M, 1950-01-10, 1464))\n(2075,(1.8287197764247496,Ayotte, Kelly, Republican, sen, NH, F, 1968-06-27, 2075))\n(1692,(1.821384657997237,Cornyn, John, Republican, sen, TX, M, 1952-02-02, 1692))\n(1881,(1.8159867803476473,Barrasso, John, Republican, sen, WY, M, 1952-07-21, 1881))\n(174,(1.7510264208985589,Cardin, Benjamin, Democrat, sen, MD, M, 1943-10-05, 174))\n(924,(1.6806446760622122,Portman, Robert, Republican, sen, OH, M, 1955-12-19, 924))\n(1534,(1.6694676278329308,Thune, John, Republican, sen, SD, M, 1961-01-07, 1534))\n(2084,(1.6448610776631065,Rubio, Marco, Republican, sen, FL, M, 1971-05-28, 2084))\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 59
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "Made a little bit of difference. Was:\n1. (457,(2.808990168767133,Grassley, Charles, Republican, sen, IA, M, 1933-09-17, 457))\n* (1351,(2.5081412232163727,Hatch, Orrin, Republican, sen, UT, M, 1934-03-22, 1351))\n* (1534,(2.141766072140464,Thune, John, Republican, sen, SD, M, 1961-01-07, 1534))\n* (174,(1.9820122202876937,Cardin, Benjamin, Democrat, sen, MD, M, 1943-10-05, 174))\n* (1507,(1.9525179592883732,Moran, Jerry, Republican, sen, KS, M, 1954-05-29, 1507))\n* (924,(1.9489782665009152,Portman, Robert, Republican, sen, OH, M, 1955-12-19, 924))\n* (1464,(1.939751138809017,Blunt, Roy, Republican, sen, MO, M, 1950-01-10, 1464))\n* (2080,(1.8962890475999443,Lee, Mike, Republican, sen, UT, M, 1971-06-04, 2080))\n* (1692,(1.8933604413943212,Cornyn, John, Republican, sen, TX, M, 1952-02-02, 1692))\n* (2084,(1.8182703984116717,Rubio, Marco, Republican, sen, FL, M, 1971-05-28, 2084))"
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Who are the most influencial co-sponsors? Flip the Edges ... **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "val senateFlippedEdges = senateGroupedEdgesGraph.edges.map(e => Edge(e.dstId, e.srcId, e.attr))",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "senateFlippedEdges: org.apache.spark.rdd.RDD[org.apache.spark.graphx.Edge[None.type]] = MapPartitionsRDD[1763] at map at <console>:76\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "MapPartitionsRDD[1763] at map at &lt;console&gt;:76"
      },
      "output_type" : "execute_result",
      "execution_count" : 60
    } ]
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "senateFlippedEdges.take(5).foreach(println)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "Edge(136,116,None)\nEdge(172,116,None)\nEdge(174,116,None)\nEdge(250,116,None)\nEdge(326,116,None)\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 61
    } ]
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "val senateFlippedEdgesGraph = Graph(senateGroupedEdgesGraph.vertices, senateFlippedEdges)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "senateFlippedEdgesGraph: org.apache.spark.graphx.Graph[Legislator,None.type] = org.apache.spark.graphx.impl.GraphImpl@41a1c1bb\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "org.apache.spark.graphx.impl.GraphImpl@41a1c1bb"
      },
      "output_type" : "execute_result",
      "execution_count" : 62
    } ]
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "val senateFlippedEdgesPageRank = senateFlippedEdgesGraph.ops.pageRank(0.0001)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "senateFlippedEdgesPageRank: org.apache.spark.graphx.Graph[Double,Double] = org.apache.spark.graphx.impl.GraphImpl@46f46400\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "org.apache.spark.graphx.impl.GraphImpl@46f46400"
      },
      "output_type" : "execute_result",
      "execution_count" : 63
    } ]
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "senateFlippedEdgesPageRank.\n  vertices.\n  join(senateVertices).\n  sortBy(_._2._1, ascending = false).\n  take(10).\n  foreach(println)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "(1558,(1.6246007724623277,Baldwin, Tammy, Democrat, sen, WI, F, 1962-02-11, 1558))\n(1969,(1.586210583479223,Franken, Alan, Democrat, sen, MN, M, 1951-05-21, 1969))\n(2075,(1.5668018510906645,Ayotte, Kelly, Republican, sen, NH, F, 1968-06-27, 2075))\n(1866,(1.5149661220558377,Gillibrand, Kirsten, Democrat, sen, NY, F, 1966-12-09, 1866))\n(1901,(1.4833107633065732,Shaheen, Jeanne, Democrat, sen, NH, F, 1947-01-28, 1901))\n(2076,(1.441968638249058,Blumenthal, Richard, Democrat, sen, CT, M, 1946-02-13, 2076))\n(1541,(1.4363419068045293,Collins, Susan, Republican, sen, ME, F, 1952-12-07, 1541))\n(1984,(1.410056299334343,Coons, Chris, Democrat, sen, DE, M, 1963-09-09, 1984))\n(1900,(1.3819768989330523,Merkley, Jeff, Democrat, sen, OR, M, 1956-10-24, 1900))\n(1826,(1.3525807961220602,Klobuchar, Amy, Democrat, sen, MN, F, 1960-05-25, 1826))\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 64
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** What would the results look like if I limit the bills to just those that have been enacted? **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "val enactedBills = bills.filter(_.isEnacted)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "enactedBills: org.apache.spark.rdd.RDD[Bill] = MapPartitionsRDD[2587] at filter at <console>:64\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "MapPartitionsRDD[2587] at filter at &lt;console&gt;:64"
      },
      "output_type" : "execute_result",
      "execution_count" : 65
    } ]
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "val enactedSenateBills = enactedBills.filter(_.isSenateBill)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "enactedSenateBills: org.apache.spark.rdd.RDD[Bill] = MapPartitionsRDD[2588] at filter at <console>:65\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "MapPartitionsRDD[2588] at filter at &lt;console&gt;:65"
      },
      "output_type" : "execute_result",
      "execution_count" : 66
    } ]
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "val enactedHouseBills = enactedBills.filter(_.isHouseBill)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "enactedHouseBills: org.apache.spark.rdd.RDD[Bill] = MapPartitionsRDD[2589] at filter at <console>:65\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : "MapPartitionsRDD[2589] at filter at &lt;console&gt;:65"
      },
      "output_type" : "execute_result",
      "execution_count" : 67
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Sponsor Influence on Co-Sponsors (cosponsor -> sponsor), Enacted Senate Bills **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "Graph(\n  senateVertices,\n  enactedSenateBills.flatMap(bill => bill.cosponsorThomasIds.map(cosponsorId => Edge(cosponsorId, bill.sponsorThomasId, None)))\n).\n  // groupEdges { case (edge1, _) => edge1 }. // didn't have any effect on the top 10\n  ops.\n  pageRank(0.0001).\n  vertices.\n  join(senateVertices).\n  sortBy(_._2._1, ascending = false).\n  take(10).\n  foreach(println)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "(174,(17.69268295066313,Cardin, Benjamin, Democrat, sen, MD, M, 1943-10-05, 174))\n(1332,(15.987013929228453,Feinstein, Dianne, Democrat, sen, CA, F, 1933-06-22, 1332))\n(1692,(15.414932484741131,Cornyn, John, Republican, sen, TX, M, 1952-02-02, 1692))\n(2084,(8.036911601555213,Rubio, Marco, Republican, sen, FL, M, 1971-05-28, 2084))\n(2086,(7.828765254031829,Johnson, Ron, Republican, sen, WI, M, 1955-04-08, 2086))\n(1395,(4.081848374090866,McConnell, Mitch, Republican, sen, KY, M, 1942-02-20, 1395))\n(179,(2.598805066379137,Carper, Thomas, Democrat, sen, DE, M, 1947-01-23, 179))\n(924,(1.0921062203377447,Portman, Robert, Republican, sen, OH, M, 1955-12-19, 924))\n(1247,(1.042753043951956,Wyden, Ron, Democrat, sen, OR, M, 1949-05-03, 1247))\n(1226,(1.0383841677295917,Wicker, Roger, Republican, sen, MS, M, 1951-07-05, 1226))\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 68
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** What enacted bills did Benjamin Cardin sponsor? **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "enactedSenateBills.filter(bill => bill.sponsorThomasId == 174).foreach(println)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "Bill(285417825,s665-114,s,ENACTED:SIGNED,A bill to encourage, enhance, and integrate Blue Alert plans throughout the United States in order to disseminate information when a law enforcement officer is seriously injured or killed in the line of duty, is missing in connection with the officer's official duties, or an imminent and credible threat that an individual intends to cause the serious injury or death of a law enforcement officer is received, and for other purposes.,174,List(2076, 1464, 2194, 116, 136, 1984, 1692, 326, 1332, 1969, 452, 457, 2174, 2079, 1826, 1383, 1395, 791, 859, 1929, 924, 1036, 1901, 2291, 2085, 1897, 1823))\nBill(-1351926175,s599-114,s,ENACTED:SIGNED,A bill to extend and expand the Medicaid emergency psychiatric demonstration project.,174,List(1464, 136, 153, 1676, 1541, 1969, 1983, 1820, 802, 1837, 1548, 1531, 2085, 1823))\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 69
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** What enacted bills did Benjamin Cardin co-sponsor? **\n\nCornyn and Rubio's bills!"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "enactedSenateBills.filter(bill => bill.cosponsorThomasIds.contains(174)).foreach(println)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "Bill(222935778,s802-114,s,ENACTED:SIGNED,A bill to authorize the Secretary of State and the Administrator of the United States Agency for International Development to provide assistance to support the rights of women and girls in developing countries, and for other purposes.,2084,List(174, 1984, 1866, 1901, 1226))\nBill(344491079,s1356-114,s,ENACTED:SIGNED,An act to authorize appropriations for fiscal year 2016 for military activities of the Department of Defense, for military construction, and for defense activities of the Department of Energy, to prescribe military personnel strengths for such fiscal year, and for other purposes.,2086,List(174, 754, 1829))\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 70
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Sponsor Influence on Co-Sponsors (co-sponsor -> sponsor), Enacted House Bills **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "Graph(\n  houseVertices,\n  enactedHouseBills.flatMap(bill => bill.cosponsorThomasIds.map(cosponsorId => Edge(cosponsorId, bill.sponsorThomasId, None)))\n).\n  // groupEdges { case (edge1, _) => edge1 }. // didn't make any difference in the top 10\n  ops.\n  pageRank(0.0001).\n  vertices.\n  join(houseVertices).\n  sortBy(_._2._1, ascending = false).\n  take(10).\n  foreach(println)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "(1922,(44.58763982783627,Guthrie, Brett, Republican, rep, KY, M, 1964-02-18, 1922))\n(1988,(37.297472008233385,Sewell, Terri, Democrat, rep, AL, F, 1965-01-01, 1988))\n(1793,(36.17070380032574,Fortenberry, Jeff, Republican, rep, NE, M, 1960-12-27, 1793))\n(2126,(5.18679787506991,Davis, Rodney, Republican, rep, IL, M, 1970-01-05, 2126))\n(1840,(3.5731452207754413,Buchanan, Vern, Republican, rep, FL, M, 1951-05-08, 1840))\n(1075,(1.9558148281294818,Smith, Lamar, Republican, rep, TX, M, 1947-11-19, 1075))\n(2003,(1.8733800128233309,Ross, Dennis, Republican, rep, FL, M, 1959-10-18, 2003))\n(1856,(1.781634380662504,Walz, Timothy, Democrat, rep, MN, M, 1964-04-06, 1856))\n(1807,(1.6746879058594404,Cuellar, Henry, Democrat, rep, TX, M, 1955-09-19, 1807))\n(1686,(1.6025111458168406,Lynch, Stephen, Democrat, rep, MA, M, 1955-03-31, 1686))\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 93
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** What enacted bills did Brett Guthrie sponsor? **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "enactedHouseBills.filter(bill => bill.sponsorThomasId == 1922).foreach(println)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "Bill(-255443722,hr1624-114,hr,ENACTED:SIGNED,To amend title I of the Patient Protection and Affordable Care Act and title XXVII of the Public Health Service Act to revise the definition of small employer.,1922,List(1460, 2229, 2239, 2090, 2257, 2054, 2131, 62, 2027, 2102, 1838, 2249, 91, 2063, 1748, 2241, 2243, 1787, 1468, 2203, 2155, 1987, 2129, 2106, 1840, 2018, 1751, 2127, 2197, 165, 2107, 1999, 1889, 2236, 1752, 1864, 1790, 1912, 1878, 1742, 2151, 2121, 2273, 231, 1774, 2266, 2144, 1989, 1643, 1807, 1670, 2235, 2126, 1641, 279, 1995, 1799, 2227, 2062, 1717, 2013, 2123, 2072, 2057, 322, 2036, 2253, 2067, 1797, 2061, 1924, 2065, 1683, 1793, 1707, 1973, 2049, 2043, 446, 1992, 2058, 2234, 1487, 2245, 1656, 2276, 2038, 478, 2044, 2260, 1933, 2032, 2040, 1749, 2071, 2237, 2143, 2140, 2101, 2028, 2015, 1909, 2269, 1921, 2046, 603, 2199, 612, 2154, 2264, 2051, 2294, 2134, 1498, 2014, 1907, 2228, 2145, 2100, 1936, 1668, 1885, 2230, 1781, 699, 1846, 2033, 2238, 2271, 2111, 711, 1931, 2146, 1960, 2258, 2150, 1806, 2053, 1804, 1908, 1792, 2074, 1809, 2225, 2142, 2052, 2130, 1685, 2248, 2156, 2059, 1744, 1758, 2275, 2060, 867, 1710, 1955, 1930, 1738, 2113, 1802, 2247, 1910, 2022, 1915, 1967, 2268, 1982, 2048, 2073, 2262, 2160, 2068, 1986, 1954, 977, 2017, 1916, 985, 1848, 2003, 2158, 2256, 2109, 2265, 1009, 1757, 1522, 1012, 1994, 2009, 1041, 1525, 1527, 1681, 1590, 2099, 1860, 1071, 2191, 1075, 2263, 2047, 1952, 1593, 1664, 1997, 2231, 1741, 2105, 2166, 2167, 2137, 1855, 1596, 2255, 2128, 2232, 2161, 2002, 2152, 2224, 1779, 1222, 2165, 1688, 1886, 1991, 2021, 2115, 2242, 1256, 2019, 2254))\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 94
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** What enacted bills did Brett Guthrie co-sponsor? **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "enactedHouseBills.filter(bill => bill.cosponsorThomasIds.contains(1922)).foreach(println)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "Bill(214187138,hr893-114,hr,ENACTED:SIGNED,To require the Secretary of the Treasury to mint coins in commemoration of the centennial of Boys Town, and for other purposes.,1793,List(2244, 1460, 2229, 2257, 2270, 2131, 62, 1996, 2153, 70, 2027, 2102, 2272, 1838, 1753, 91, 2063, 1748, 99, 1787, 1469, 2203, 1987, 2129, 132, 1840, 2018, 1751, 2127, 2197, 1471, 1564, 2107, 1752, 1839, 2163, 186, 2055, 2200, 1790, 1912, 1878, 1742, 2151, 2121, 2273, 1805, 1959, 229, 231, 1774, 1836, 2144, 1643, 1604, 1807, 1670, 256, 2235, 2126, 279, 2133, 281, 1995, 1799, 2227, 2062, 1976, 1717, 2251, 303, 2013, 316, 2123, 2072, 2057, 322, 1894, 1857, 2036, 2253, 344, 355, 2114, 2067, 368, 2064, 1797, 2061, 1924, 2119, 1707, 414, 2122, 1973, 1737, 1801, 446, 1992, 2234, 1487, 2245, 1656, 1979, 1914, 462, 2070, 2276, 2038, 1922, 2044, 2260, 1933, 2026, 2032, 511, 2170, 2040, 2237, 1794, 2223, 1490, 2143, 566, 2140, 2020, 2101, 2015, 1909, 2269, 2069, 1663, 1640, 2278, 2046, 599, 603, 2199, 612, 2154, 616, 2051, 2172, 2134, 2169, 1498, 635, 1724, 2014, 1733, 2145, 2100, 1834, 1936, 1668, 1885, 688, 1781, 699, 1846, 701, 2033, 2111, 709, 1931, 1960, 1686, 729, 1806, 2053, 1814, 1804, 1504, 1792, 2074, 1809, 2052, 1506, 2130, 800, 1685, 2277, 2246, 2117, 1744, 850, 854, 2275, 2060, 867, 2202, 868, 2001, 1710, 2162, 1955, 2035, 887, 1510, 1930, 1738, 1835, 2113, 910, 1514, 1802, 2247, 2022, 930, 1778, 1967, 944, 1982, 1810, 2048, 2073, 2160, 2023, 2068, 1986, 977, 1704, 979, 2017, 1916, 1848, 2003, 2158, 998, 1728, 1003, 1560, 1756, 1009, 1757, 1522, 1012, 1854, 1892, 1588, 1635, 1920, 1950, 1722, 1037, 1041, 1042, 1526, 1527, 1590, 2099, 1860, 1071, 2191, 1075, 1890, 2263, 2168, 2047, 2104, 2110, 1952, 1593, 1664, 1997, 1940, 1942, 1884, 1741, 1177, 2105, 2112, 2166, 1188, 2137, 1855, 1596, 2128, 1856, 1777, 2161, 2002, 1879, 2152, 1779, 1222, 2165, 2004, 1688, 1886, 2008, 1853, 2021, 2115, 2242, 1256))\nBill(59983530,hr431-114,hr,ENACTED:SIGNED,To award a Congressional Gold Medal to the Foot Soldiers who participated in Bloody Sunday, Turnaround Tuesday, or the final Selma to Montgomery Voting Rights March in March of 1965, which served as a catalyst for the Voting Rights Act of 1965.,1988,List(2244, 2201, 1460, 2229, 2239, 2090, 2257, 2131, 1996, 2153, 70, 2027, 2102, 2272, 91, 2063, 1748, 99, 2092, 1723, 1787, 2267, 1469, 2203, 1987, 2129, 132, 2106, 2233, 2127, 1761, 2197, 1471, 1564, 2107, 1999, 1889, 2159, 1839, 2163, 1970, 2055, 2196, 1864, 2200, 1654, 1790, 208, 1878, 2273, 1805, 1959, 229, 231, 1774, 1836, 2144, 1643, 1604, 1807, 1670, 256, 1477, 2126, 1641, 1479, 2133, 281, 2096, 1799, 2116, 2227, 1976, 2251, 303, 2013, 2072, 2057, 322, 1894, 1857, 2036, 344, 355, 2114, 368, 371, 2064, 1797, 2061, 2065, 1888, 2119, 1895, 2122, 2226, 1973, 2043, 1801, 1992, 2058, 2234, 1487, 1979, 1914, 1803, 462, 2070, 1708, 1922, 478, 2089, 2044, 2260, 2032, 511, 2170, 2071, 1794, 2223, 1913, 1490, 1634, 566, 2101, 2015, 1909, 2269, 2069, 1663, 1640, 588, 2149, 2278, 1921, 2046, 599, 1843, 2199, 2154, 616, 2025, 2051, 2190, 2172, 2134, 2169, 1498, 2014, 1907, 2145, 2100, 1936, 1668, 1675, 1583, 2252, 1501, 683, 688, 2230, 1781, 1846, 701, 2271, 2111, 709, 2146, 1939, 1960, 1686, 729, 2150, 1814, 1804, 1908, 1653, 766, 1504, 1809, 1832, 2225, 2142, 2052, 1506, 2148, 2130, 2248, 1811, 2246, 2156, 2059, 2117, 850, 1602, 854, 1758, 2275, 2060, 867, 2202, 868, 2162, 1955, 887, 2221, 1510, 1930, 2097, 905, 2113, 910, 1953, 1927, 1514, 2274, 2171, 2247, 1910, 930, 1967, 944, 1982, 2048, 2262, 2160, 2023, 1986, 1704, 1916, 985, 2158, 2256, 997, 998, 2109, 1728, 1003, 1756, 1962, 1009, 1757, 1522, 1854, 1892, 1588, 1635, 1920, 1950, 1994, 2009, 1722, 1037, 1041, 1042, 1525, 1526, 1527, 1681, 1590, 2099, 1818, 1069, 1528, 1860, 1890, 2047, 2104, 2240, 2110, 1151, 1593, 1664, 1997, 1940, 1942, 2231, 1884, 1741, 1177, 2105, 1729, 2112, 2166, 2167, 1184, 1188, 2128, 1856, 1777, 1205, 2259, 2161, 2002, 1879, 2152, 2004, 1991, 1853, 2021, 1256, 2019, 2261))\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 95
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Co-sponsor Influence on Sponsors (sponsor -> co-sponsor), Enacted Senate Bills **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "Graph(\n  senateVertices,\n  enactedSenateBills.flatMap(bill => bill.cosponsorThomasIds.map(cosponsorId => Edge(bill.sponsorThomasId, cosponsorId, bill.id)))\n).\n  // groupEdges { case (edge1, _) => edge1 }. // made no difference in the top 10\n  ops.\n  pageRank(0.0001).\n  vertices.\n  join(senateVertices).\n  sortBy(_._2._1, ascending = false).\n  take(10).\n  foreach(println)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "(2076,(0.36997560259343604,Blumenthal, Richard, Democrat, sen, CT, M, 1946-02-13, 2076))\n(1969,(0.35129926289044844,Franken, Alan, Democrat, sen, MN, M, 1951-05-21, 1969))\n(859,(0.30941410010126935,Nelson, Bill, Democrat, sen, FL, M, 1942-09-29, 859))\n(2290,(0.29358031655844147,Sullivan, Dan, Republican, sen, AK, M, 1964-11-13, 2290))\n(1984,(0.28445102072286677,Coons, Chris, Democrat, sen, DE, M, 1963-09-09, 1984))\n(1937,(0.2807178394372064,Heinrich, Martin, Democrat, sen, NM, M, 1971-10-17, 1937))\n(1383,(0.27198926773122883,Leahy, Patrick, Democrat, sen, VT, M, 1940-03-31, 1383))\n(1965,(0.2643736004568694,Bennet, Michael, Democrat, sen, CO, M, 1964-11-28, 1965))\n(1531,(0.24013379147476327,Stabenow, Debbie, Democrat, sen, MI, F, 1950-04-29, 1531))\n(1036,(0.24010882329086697,Schumer, Charles, Democrat, sen, NY, M, 1950-11-23, 1036))\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 96
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** What enacted bills did Richard Blumenthal sponsor? **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "enactedSenateBills.filter(bill => bill.sponsorThomasId == 2076).foreach(println)",
    "outputs" : [ {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 97
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** What enacted bills did Richard Blumenthal co-sponsor? **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "enactedSenateBills.filter(bill => bill.cosponsorThomasIds.contains(2076)).foreach(println)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "Bill(1991247082,s2082-114,s,ENACTED:SIGNED,A bill to amend title 38, United States Code, to extend certain expiring provisions of law administered by the Secretary of Veterans Affairs, and for other purposes.,1608,List(2076))\nBill(285417825,s665-114,s,ENACTED:SIGNED,A bill to encourage, enhance, and integrate Blue Alert plans throughout the United States in order to disseminate information when a law enforcement officer is seriously injured or killed in the line of duty, is missing in connection with the officer's official duties, or an imminent and credible threat that an individual intends to cause the serious injury or death of a law enforcement officer is received, and for other purposes.,174,List(2076, 1464, 2194, 116, 136, 1984, 1692, 326, 1332, 1969, 452, 457, 2174, 2079, 1826, 1383, 1395, 791, 859, 1929, 924, 1036, 1901, 2291, 2085, 1897, 1823))\nBill(827267788,s178-114,s,ENACTED:SIGNED,A bill to provide justice for the victims of trafficking.,1692,List(2075, 2076, 1464, 1687, 1676, 1828, 209, 213, 1541, 1984, 250, 2138, 326, 1332, 2179, 1866, 452, 457, 1351, 2174, 2079, 2086, 1647, 1826, 1409, 1929, 2084, 1036, 2056, 1534, 2085, 1567, 1226, 1247, 116))\nBill(-1202427337,s2425-114,s,ENACTED:SIGNED,A bill to amend titles XVIII and XIX of the Social Security Act to improve payments for complex rehabilitation technology and certain radiation therapy services, to ensure flexibility in applying the hardship exception for meaningful use for the 2015 EHR reporting period for 2017 payment adjustments, and for other purposes.,924,List(1965, 2076, 1464, 153, 1828, 1844, 1826, 1409, 1036, 1247))\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 98
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** Co-sponsor Influence on Sponsors (sponsor -> co-sponsor), Enacted House Bills **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "Graph(\n  houseVertices,\n  enactedHouseBills.flatMap(bill => bill.cosponsorThomasIds.map(cosponsorId => Edge(bill.sponsorThomasId, cosponsorId, None)))\n).\n  // groupEdges { case (edge1, _) => edge1 }.\n  ops.\n  pageRank(0.0001).\n  vertices.\n  join(houseVertices).\n  sortBy(_._2._1, ascending = false).\n  take(10).\n  foreach(println)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "(1982,(0.3403255356228539,Reed, Tom, Republican, rep, NY, M, 1971-11-18, 1982))\n(1469,(0.32588344785121093,Brady, Robert, Democrat, rep, PA, M, 1945-04-07, 1469))\n(944,(0.30391862890616617,Rangel, Charles, Democrat, rep, NY, M, 1930-06-11, 944))\n(1668,(0.2974351506322524,Langevin, James, Democrat, rep, RI, M, 1964-04-22, 1668))\n(1804,(0.29626678754251085,McCaul, Michael, Republican, rep, TX, M, 1962-01-14, 1804))\n(1848,(0.29468614797649784,Roskam, Peter, Republican, rep, IL, M, 1961-09-13, 1848))\n(2225,(0.2644410819049362,McSally, Martha, Republican, rep, AZ, F, 1966-03-22, 2225))\n(1742,(0.2537511856830064,Cole, Tom, Republican, rep, OK, M, 1949-04-28, 1742))\n(850,(0.25076904524938187,Nadler, Jerrold, Democrat, rep, NY, M, 1947-06-13, 850))\n(2148,(0.23470803915093819,Meng, Grace, Democrat, rep, NY, F, 1975-10-01, 2148))\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 99
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** What enacted bills did Tom Read sponsor? **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "enactedHouseBills.filter(bill => bill.sponsorThomasId == 1982).foreach(println)",
    "outputs" : [ {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 100
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** What enacted bills did Tom Read co-sponsor? **"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : false
    },
    "cell_type" : "code",
    "source" : "enactedHouseBills.filter(bill => bill.cosponsorThomasIds.contains(1982)).foreach(println)",
    "outputs" : [ {
      "name" : "stdout",
      "output_type" : "stream",
      "text" : "Bill(-255443722,hr1624-114,hr,ENACTED:SIGNED,To amend title I of the Patient Protection and Affordable Care Act and title XXVII of the Public Health Service Act to revise the definition of small employer.,1922,List(1460, 2229, 2239, 2090, 2257, 2054, 2131, 62, 2027, 2102, 1838, 2249, 91, 2063, 1748, 2241, 2243, 1787, 1468, 2203, 2155, 1987, 2129, 2106, 1840, 2018, 1751, 2127, 2197, 165, 2107, 1999, 1889, 2236, 1752, 1864, 1790, 1912, 1878, 1742, 2151, 2121, 2273, 231, 1774, 2266, 2144, 1989, 1643, 1807, 1670, 2235, 2126, 1641, 279, 1995, 1799, 2227, 2062, 1717, 2013, 2123, 2072, 2057, 322, 2036, 2253, 2067, 1797, 2061, 1924, 2065, 1683, 1793, 1707, 1973, 2049, 2043, 446, 1992, 2058, 2234, 1487, 2245, 1656, 2276, 2038, 478, 2044, 2260, 1933, 2032, 2040, 1749, 2071, 2237, 2143, 2140, 2101, 2028, 2015, 1909, 2269, 1921, 2046, 603, 2199, 612, 2154, 2264, 2051, 2294, 2134, 1498, 2014, 1907, 2228, 2145, 2100, 1936, 1668, 1885, 2230, 1781, 699, 1846, 2033, 2238, 2271, 2111, 711, 1931, 2146, 1960, 2258, 2150, 1806, 2053, 1804, 1908, 1792, 2074, 1809, 2225, 2142, 2052, 2130, 1685, 2248, 2156, 2059, 1744, 1758, 2275, 2060, 867, 1710, 1955, 1930, 1738, 2113, 1802, 2247, 1910, 2022, 1915, 1967, 2268, 1982, 2048, 2073, 2262, 2160, 2068, 1986, 1954, 977, 2017, 1916, 985, 1848, 2003, 2158, 2256, 2109, 2265, 1009, 1757, 1522, 1012, 1994, 2009, 1041, 1525, 1527, 1681, 1590, 2099, 1860, 1071, 2191, 1075, 2263, 2047, 1952, 1593, 1664, 1997, 2231, 1741, 2105, 2166, 2167, 2137, 1855, 1596, 2255, 2128, 2232, 2161, 2002, 2152, 2224, 1779, 1222, 2165, 1688, 1886, 1991, 2021, 2115, 2242, 1256, 2019, 2254))\nBill(-1487976123,hr606-114,hr,ENACTED:SIGNED,To amend the Internal Revenue Code of 1986 to exclude certain compensation received by public safety officers and their dependents from gross income.,1930,List(2063, 1468, 2197, 2159, 2266, 2144, 2038, 1921, 2046, 2051, 1583, 2252, 1806, 2052, 1955, 1510, 1802, 944, 1982, 1810, 2048, 1848, 1952, 1593, 2019))\nBill(1858606673,hr22-114,hr,ENACTED:SIGNED,An act to authorize funds for Federal-aid highways, highway safety programs, and transit programs, and for other purposes.,2126,List(2090, 2257, 2270, 2054, 2131, 2027, 1838, 2063, 1748, 2243, 1787, 1468, 2203, 1987, 165, 186, 2200, 1912, 1742, 2273, 2103, 2266, 2144, 1989, 2235, 1995, 2072, 322, 2036, 2253, 2067, 2064, 1797, 2061, 1707, 2122, 2049, 2043, 446, 1992, 2070, 2038, 2044, 2260, 2032, 2223, 2140, 2028, 2015, 1909, 2278, 1921, 2046, 2199, 612, 2154, 2051, 1724, 2014, 1733, 2100, 1834, 1885, 1781, 2033, 2258, 2053, 1804, 1908, 2074, 2225, 2052, 2130, 800, 1731, 1685, 2156, 1758, 2275, 2001, 2035, 1738, 2141, 2268, 1982, 2048, 2160, 2068, 1954, 2017, 1848, 2003, 2256, 2109, 1920, 1041, 1525, 1527, 2191, 2168, 2047, 1952, 1664, 2105, 2137, 1855, 1596, 2128, 2224, 1779, 1222, 2165, 1886, 1991, 2008, 2115, 2261, 2254))\nBill(-2041752531,hr1442-114,hr,ENACTED:SIGNED,To designate the facility of the United States Postal Service located at 90 Cornell Street in Kingston, New York, as the \"Staff Sergeant Robert H. Dietz Post Office Building\".,2043,List(1864, 2151, 1604, 2293, 344, 2044, 1794, 1663, 2149, 2264, 635, 709, 729, 2150, 1506, 2148, 850, 944, 1982, 2262, 1042, 1069, 2263, 1942, 1184, 2261))\nBill(1078260851,hr2146-114,hr,ENACTED:SIGNED,To amend the Internal Revenue Code of 1986 to allow Federal law enforcement officers, firefighters, and air traffic controllers to make penalty-free withdrawals from governmental plans after age 50, and for other purposes.,1810,List(1797, 2001, 1510, 944, 1982))\nBill(1229092033,hr1350-114,hr,ENACTED:SIGNED,To designate the facility of the United States Postal Service located at 442 East 167th Street in Bronx, New York, as the \"Herman Badillo Post Office Building\".,1042,List(1864, 2151, 1604, 2293, 344, 2043, 2044, 1794, 1663, 2149, 2264, 635, 709, 729, 2150, 1506, 2148, 850, 944, 1982, 2262, 1069, 2263, 1942, 1184, 2261))\nBill(169757621,hr1314-114,hr,ENACTED:SIGNED,To amend the Internal Revenue Code of 1986 to provide for a right to an administrative appeal relating to adverse determinations of tax-exempt status of certain organizations.,2052,List(1982, 1848))\nBill(214187138,hr893-114,hr,ENACTED:SIGNED,To require the Secretary of the Treasury to mint coins in commemoration of the centennial of Boys Town, and for other purposes.,1793,List(2244, 1460, 2229, 2257, 2270, 2131, 62, 1996, 2153, 70, 2027, 2102, 2272, 1838, 1753, 91, 2063, 1748, 99, 1787, 1469, 2203, 1987, 2129, 132, 1840, 2018, 1751, 2127, 2197, 1471, 1564, 2107, 1752, 1839, 2163, 186, 2055, 2200, 1790, 1912, 1878, 1742, 2151, 2121, 2273, 1805, 1959, 229, 231, 1774, 1836, 2144, 1643, 1604, 1807, 1670, 256, 2235, 2126, 279, 2133, 281, 1995, 1799, 2227, 2062, 1976, 1717, 2251, 303, 2013, 316, 2123, 2072, 2057, 322, 1894, 1857, 2036, 2253, 344, 355, 2114, 2067, 368, 2064, 1797, 2061, 1924, 2119, 1707, 414, 2122, 1973, 1737, 1801, 446, 1992, 2234, 1487, 2245, 1656, 1979, 1914, 462, 2070, 2276, 2038, 1922, 2044, 2260, 1933, 2026, 2032, 511, 2170, 2040, 2237, 1794, 2223, 1490, 2143, 566, 2140, 2020, 2101, 2015, 1909, 2269, 2069, 1663, 1640, 2278, 2046, 599, 603, 2199, 612, 2154, 616, 2051, 2172, 2134, 2169, 1498, 635, 1724, 2014, 1733, 2145, 2100, 1834, 1936, 1668, 1885, 688, 1781, 699, 1846, 701, 2033, 2111, 709, 1931, 1960, 1686, 729, 1806, 2053, 1814, 1804, 1504, 1792, 2074, 1809, 2052, 1506, 2130, 800, 1685, 2277, 2246, 2117, 1744, 850, 854, 2275, 2060, 867, 2202, 868, 2001, 1710, 2162, 1955, 2035, 887, 1510, 1930, 1738, 1835, 2113, 910, 1514, 1802, 2247, 2022, 930, 1778, 1967, 944, 1982, 1810, 2048, 2073, 2160, 2023, 2068, 1986, 977, 1704, 979, 2017, 1916, 1848, 2003, 2158, 998, 1728, 1003, 1560, 1756, 1009, 1757, 1522, 1012, 1854, 1892, 1588, 1635, 1920, 1950, 1722, 1037, 1041, 1042, 1526, 1527, 1590, 2099, 1860, 1071, 2191, 1075, 1890, 2263, 2168, 2047, 2104, 2110, 1952, 1593, 1664, 1997, 1940, 1942, 1884, 1741, 1177, 2105, 2112, 2166, 1188, 2137, 1855, 1596, 2128, 1856, 1777, 2161, 2002, 1879, 2152, 1779, 1222, 2165, 2004, 1688, 1886, 2008, 1853, 2021, 2115, 2242, 1256))\nBill(1310403786,hr1295-114,hr,ENACTED:SIGNED,An act to extend the African Growth and Opportunity Act, the Generalized System of Preferences, the preferential duty treatment program for Haiti, and for other purposes.,2143,List(1982, 1848))\nBill(59983530,hr431-114,hr,ENACTED:SIGNED,To award a Congressional Gold Medal to the Foot Soldiers who participated in Bloody Sunday, Turnaround Tuesday, or the final Selma to Montgomery Voting Rights March in March of 1965, which served as a catalyst for the Voting Rights Act of 1965.,1988,List(2244, 2201, 1460, 2229, 2239, 2090, 2257, 2131, 1996, 2153, 70, 2027, 2102, 2272, 91, 2063, 1748, 99, 2092, 1723, 1787, 2267, 1469, 2203, 1987, 2129, 132, 2106, 2233, 2127, 1761, 2197, 1471, 1564, 2107, 1999, 1889, 2159, 1839, 2163, 1970, 2055, 2196, 1864, 2200, 1654, 1790, 208, 1878, 2273, 1805, 1959, 229, 231, 1774, 1836, 2144, 1643, 1604, 1807, 1670, 256, 1477, 2126, 1641, 1479, 2133, 281, 2096, 1799, 2116, 2227, 1976, 2251, 303, 2013, 2072, 2057, 322, 1894, 1857, 2036, 344, 355, 2114, 368, 371, 2064, 1797, 2061, 2065, 1888, 2119, 1895, 2122, 2226, 1973, 2043, 1801, 1992, 2058, 2234, 1487, 1979, 1914, 1803, 462, 2070, 1708, 1922, 478, 2089, 2044, 2260, 2032, 511, 2170, 2071, 1794, 2223, 1913, 1490, 1634, 566, 2101, 2015, 1909, 2269, 2069, 1663, 1640, 588, 2149, 2278, 1921, 2046, 599, 1843, 2199, 2154, 616, 2025, 2051, 2190, 2172, 2134, 2169, 1498, 2014, 1907, 2145, 2100, 1936, 1668, 1675, 1583, 2252, 1501, 683, 688, 2230, 1781, 1846, 701, 2271, 2111, 709, 2146, 1939, 1960, 1686, 729, 2150, 1814, 1804, 1908, 1653, 766, 1504, 1809, 1832, 2225, 2142, 2052, 1506, 2148, 2130, 2248, 1811, 2246, 2156, 2059, 2117, 850, 1602, 854, 1758, 2275, 2060, 867, 2202, 868, 2162, 1955, 887, 2221, 1510, 1930, 2097, 905, 2113, 910, 1953, 1927, 1514, 2274, 2171, 2247, 1910, 930, 1967, 944, 1982, 2048, 2262, 2160, 2023, 1986, 1704, 1916, 985, 2158, 2256, 997, 998, 2109, 1728, 1003, 1756, 1962, 1009, 1757, 1522, 1854, 1892, 1588, 1635, 1920, 1950, 1994, 2009, 1722, 1037, 1041, 1042, 1525, 1526, 1527, 1681, 1590, 2099, 1818, 1069, 1528, 1860, 1890, 2047, 2104, 2240, 2110, 1151, 1593, 1664, 1997, 1940, 1942, 2231, 1884, 1741, 1177, 2105, 1729, 2112, 2166, 2167, 1184, 1188, 2128, 1856, 1777, 1205, 2259, 2161, 2002, 1879, 2152, 2004, 1991, 1853, 2021, 1256, 2019, 2261))\nBill(910535246,hr1884-114,hr,ENACTED:SIGNED,To designate the facility of the United States Postal Service located at 206 West Commercial Street in East Rochester, New York, as the \"Officer Daryl R. Pierson Memorial Post Office Building\".,1069,List(1864, 2151, 1604, 2293, 344, 2043, 2044, 1794, 1663, 2149, 2264, 635, 709, 729, 2150, 1506, 2148, 850, 944, 1982, 2262, 1042, 2263, 1942, 1184, 2261))\nBill(-81079860,hr1191-114,hr,ENACTED:SIGNED,A bill to provide for congressional review and oversight of agreements relating to Iran's nuclear program, and for other purposes.,2054,List(2239, 2257, 2243, 2159, 2266, 1836, 1799, 2061, 414, 2043, 1992, 2070, 2044, 2020, 2051, 1960, 2053, 2074, 1744, 1982, 2158, 1952, 1991))\n"
    }, {
      "metadata" : { },
      "data" : {
        "text/html" : ""
      },
      "output_type" : "execute_result",
      "execution_count" : 101
    } ]
  }, {
    "metadata" : { },
    "cell_type" : "markdown",
    "source" : "** TODO: **\n* Why, if Bill Shuster sponsored five enacted bills, is he not one of the top influencers?\n* What do the results look like if we limit the bills to just those that have actaully been enacted?\n* Who are the most influencial co-sponsors (i.e. reverse the direction of the edges)?\n* Committees:\n* Which committees pass the most bills?\n* Which committees are the most influencial according to page rank?\n* Who are the most influencial legislators based on the committees they belong to?\n* Who produces the most busy work?\n* Which committees are the most likely to pass/kill a bill?\n* What are the bills about (topics)?\n* What topics are the most interesting?\n* What topics are most likely to have bills that pass?\n* What makes a bill likely to pass?\n* Who votes the most/least?\n* Who's the most influencial based on vote?\n* What is the breakdown of votes (yes/no) across parties.\n* If I vote yes, who's likely to vote no?\n* What are the most influential bills? I.e. related bills whose existence might cause others to pass?\n* What's the relationship between related bills, sponsors, committee rank, and passing bills. I.e. what makes a bill likely to pass?\n* What's roles to women/men most often play? Sponsor? Co-sponsor?\n* How often do bills pass when sponsored or cosponsored by men/women?\n* How often do people team up on the same bills?\n* How often to the same men/women team up on the same bills?\n* Does the date/day/time-of-week/time in which a bill is generated and or sent to committee affect the bill's likelihood of passing?\n* How often do bills passed from house to senate, or senate to house, pass both houses?\n* How often are bills vetoed?\n* Who's bills (person/party) are most often vetoed?\n* Which party generates the most bills?\n* Which party generates the most regulations?\n* How often to legislators cross party lines? Who is most likely to cross party lines?"
  }, {
    "metadata" : {
      "trusted" : true,
      "input_collapsed" : false,
      "collapsed" : true
    },
    "cell_type" : "code",
    "source" : "",
    "outputs" : [ ]
  } ],
  "nbformat" : 4
}